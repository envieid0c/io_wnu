#if 0
	shc Version 3.9.3a3, Generic Shell Script Compiler
	GNU GPL Version 3 Fedor Mankov <envieidoc@gmail.com>

	./shc -v -r -f io_wnu_uninstall.command 
#endif

static  char data [] = 
#define      msg1_z	62
#define      msg1	((&data[7]))
	"\005\177\212\161\330\120\056\043\105\357\347\230\060\022\032\251"
	"\365\313\240\370\116\060\043\367\250\341\154\014\126\047\055\157"
	"\365\243\315\023\125\367\024\220\061\301\017\351\010\342\341\124"
	"\302\162\000\372\000\205\072\353\244\033\163\013\145\151\255\043"
	"\265\351\250\046\263\332\036"
#define      tst2_z	19
#define      tst2	((&data[75]))
	"\176\143\043\114\303\017\012\177\132\207\371\342\245\361\126\034"
	"\023\043\224\054\274\201\324"
#define      chk1_z	22
#define      chk1	((&data[99]))
	"\156\254\266\341\035\233\256\327\212\242\357\321\035\344\116\245"
	"\070\053\057\124\313\014\103\063\104\263\245"
#define      xecc_z	15
#define      xecc	((&data[121]))
	"\166\130\056\004\132\122\123\310\370\117\206\077\140\157\043\135"
	"\065"
#define      pswd_z	256
#define      pswd	((&data[178]))
	"\327\302\054\013\043\213\074\157\256\206\364\025\144\222\035\043"
	"\265\236\300\363\005\073\045\125\355\251\253\115\136\305\106\373"
	"\135\272\150\304\206\264\015\362\243\345\266\002\001\174\014\152"
	"\100\124\224\035\245\354\062\371\146\037\073\372\001\036\167\335"
	"\267\073\014\133\141\234\045\114\145\073\133\337\252\354\354\212"
	"\041\021\043\076\012\234\170\253\304\162\033\157\005\201\341\356"
	"\014\273\143\006\032\030\357\052\260\321\373\076\377\355\051\017"
	"\335\057\175\101\010\351\206\130\257\135\270\226\310\105\134\320"
	"\241\232\366\025\277\271\204\334\254\076\231\043\100\161\000\341"
	"\355\276\161\012\174\103\053\355\053\037\151\102\137\224\066\247"
	"\252\053\041\051\157\075\120\066\324\055\134\251\174\216\056\117"
	"\131\156\243\370\354\025\003\045\011\250\324\337\141\130\257\264"
	"\372\224\247\324\041\155\267\254\042\107\271\330\363\376\036\353"
	"\112\157\016\100\365\020\324\176\316\040\262\143\030\051\015\041"
	"\123\352\011\333\075\037\043\031\221\214\020\060\304\267\001\112"
	"\271\225\250\006\223\327\110\145\123\367\155\276\100\356\332\160"
	"\162\330\312\121\246\250\210\175\331\044\077\262\111\025\166\246"
	"\302\243\061\321\257\244\015\301\150\305\176\201\262\072\305\000"
	"\133\117\305\216\301\263\354\141\062\176\031\307\063\275\127\206"
	"\061\256\271\310\060\164\117\121\262\274\222\006\075\344\170\017"
	"\111\014\160"
#define      tst1_z	22
#define      tst1	((&data[463]))
	"\026\157\371\135\007\321\244\341\173\343\372\355\132\216\375\210"
	"\216\075\375\106\013\030\055\207\067\353\254\145\037"
#define      shll_z	10
#define      shll	((&data[491]))
	"\160\325\374\303\075\053\206\054\133\242\231"
#define      date_z	1
#define      date	((&data[501]))
	"\234"
#define      text_z	1249
#define      text	((&data[760]))
	"\322\265\321\177\037\046\135\157\306\030\372\065\326\264\062\100"
	"\212\373\025\130\155\321\032\000\014\073\373\337\275\266\115\122"
	"\305\172\354\100\136\231\211\064\146\166\106\143\036\260\343\030"
	"\111\150\031\102\116\114\313\127\253\331\074\234\164\012\065\247"
	"\226\210\054\054\275\071\064\237\134\025\204\306\045\156\030\305"
	"\116\220\057\370\144\007\065\013\177\247\324\007\073\140\362\122"
	"\053\173\004\056\072\142\006\026\057\372\315\254\325\306\035\304"
	"\166\224\205\372\010\145\130\315\015\000\356\121\007\304\257\114"
	"\262\336\310\340\322\070\173\226\024\223\035\043\145\174\330\156"
	"\163\045\334\002\367\106\334\012\214\262\316\257\002\052\156\232"
	"\204\056\235\370\017\270\044\304\005\124\252\142\262\312\170\212"
	"\117\211\125\361\156\377\250\243\111\302\002\160\261\353\344\376"
	"\113\161\146\201\112\363\366\346\036\302\253\327\033\343\233\063"
	"\255\253\231\157\135\301\011\260\064\275\337\067\355\376\107\117"
	"\277\010\112\255\003\246\046\114\361\231\366\154\205\003\006\032"
	"\055\116\107\147\070\227\243\343\001\361\175\134\276\211\165\301"
	"\333\346\176\227\301\112\066\253\124\214\360\262\263\345\351\324"
	"\234\367\141\163\207\010\343\175\220\173\371\202\163\146\132\257"
	"\036\326\002\061\151\022\202\210\303\105\233\334\140\100\302\270"
	"\112\251\135\062\107\312\016\225\027\357\364\275\016\073\053\065"
	"\001\026\047\123\145\354\311\273\217\353\157\037\211\221\120\016"
	"\023\172\176\102\213\147\130\303\043\232\221\047\375\035\322\014"
	"\223\254\321\007\253\146\234\334\170\275\326\361\377\034\303\153"
	"\237\054\036\324\034\103\014\010\146\377\204\221\171\303\253\155"
	"\023\060\334\050\232\231\015\003\060\057\352\007\243\136\227\061"
	"\125\047\374\131\214\371\310\067\064\264\022\053\210\141\014\231"
	"\013\216\367\320\217\244\175\052\374\363\160\300\210\313\304\232"
	"\267\335\227\257\344\364\376\171\366\143\256\011\317\207\164\110"
	"\333\127\203\264\224\143\033\002\344\347\315\350\247\155\135\354"
	"\372\241\021\070\047\013\106\063\101\013\213\320\272\230\142\240"
	"\276\000\227\335\131\107\246\046\377\215\104\062\161\241\174\266"
	"\124\226\000\161\370\112\370\350\027\003\134\222\232\350\356\004"
	"\374\142\040\316\157\111\305\021\346\161\070\214\144\050\120\242"
	"\301\342\125\050\317\110\171\374\226\133\252\370\127\354\157\012"
	"\102\046\217\161\377\164\100\061\245\013\012\331\266\066\172\243"
	"\330\344\306\356\241\143\212\065\322\323\073\231\370\354\023\232"
	"\106\265\062\213\050\266\265\026\322\351\341\211\260\116\201\333"
	"\320\105\300\114\263\356\046\056\161\332\153\054\226\240\357\257"
	"\044\262\203\065\100\246\350\040\256\204\040\221\046\172\242\261"
	"\302\065\250\244\377\026\110\047\263\162\312\215\322\213\217\107"
	"\101\110\315\366\237\365\077\337\107\274\243\107\176\353\355\317"
	"\045\121\200\003\213\340\317\335\330\334\234\203\115\052\015\037"
	"\054\210\053\122\236\171\223\051\160\035\165\203\310\346\136\275"
	"\357\042\037\237\045\054\344\160\327\043\056\141\235\202\037\333"
	"\303\203\045\177\162\104\074\173\355\334\112\000\361\172\151\124"
	"\276\053\136\047\245\127\105\211\351\071\132\351\305\121\161\003"
	"\301\136\347\055\306\254\255\165\247\377\306\105\254\317\307\027"
	"\017\032\204\071\001\141\051\203\123\025\155\243\140\226\151\245"
	"\130\276\136\017\064\071\334\204\017\274\313\074\143\124\070\176"
	"\161\261\014\330\365\277\265\204\343\061\302\101\224\152\234\330"
	"\222\275\265\351\146\001\177\001\367\123\240\155\136\147\371\377"
	"\354\114\302\342\037\117\245\050\036\342\110\054\160\321\060\177"
	"\360\322\110\070\243\274\047\252\273\106\057\205\134\045\237\005"
	"\060\125\130\047\106\150\214\377\030\001\010\271\351\250\055\322"
	"\353\270\361\163\110\145\010\356\334\310\377\057\151\151\133\360"
	"\311\202\006\153\114\045\133\212\001\227\070\047\160\037\060\004"
	"\076\262\224\221\230\223\311\232\156\014\335\037\226\040\346\250"
	"\272\101\034\366\066\317\136\303\376\076\204\351\132\232\046\274"
	"\301\164\171\304\216\113\027\350\015\146\146\257\052\360\244\261"
	"\152\064\220\252\023\265\363\067\144\176\276\342\333\247\107\310"
	"\372\313\146\203\034\344\151\336\253\031\106\326\253\150\224\227"
	"\265\227\103\126\331\127\163\224\343\265\300\101\215\354\027\312"
	"\257\243\333\342\244\150\030\045\113\065\110\111\044\225\355\305"
	"\356\151\331\340\164\063\257\244\054\125\142\225\230\152\147\315"
	"\163\374\373\224\253\165\203\231\165\214\357\132\326\025\130\320"
	"\165\062\172\001\170\012\171\121\374\132\173\275\047\274\100\170"
	"\211\072\102\203\030\346\110\336\224\123\344\207\322\312\256\174"
	"\326\027\330\226\072\243\112\070\165\267\244\070\201\046\056\150"
	"\261\344\071\102\335\277\122\220\377\100\364\166\263\342\250\050"
	"\125\067\326\344\061\003\326\106\072\046\370\231\252\271\202\045"
	"\157\366\250\002\163\174\203\113\010\174\335\134\043\167\306\200"
	"\205\224\061\356\357\052\042\347\305\247\104\251\254\355\106\047"
	"\223\361\000\046\333\274\246\321\246\052\115\142\121\163\003\172"
	"\117\261\231\120\272\326\163\045\353\331\243\170\053\070\155\165"
	"\051\111\027\115\074\111\171\022\015\346\061\221\067\015\135\313"
	"\315\002\175\272\307\346\234\255\331\035\251\334\325\074\367\375"
	"\253\321\310\354\226\074\316\021\150\041\341\373\267\241\137\002"
	"\217\307\153\106\334\175\155\146\275\373\321\277\331\232\123\072"
	"\035\141\344\133\124\100\067\343\102\277\330\242\255\301\170\245"
	"\240\313\251\163\141\303\267\130\252\230\216\347\107\375\077\377"
	"\260\275\107\263\105\330\212\377\264\134\326\265\034\304\025\156"
	"\266\122\133\154\042\125\133\026\225\103\227\063\345\050\145\126"
	"\200\041\133\226\220\024\132\201\216\305\044\336\025\356\004\074"
	"\224\160\121\136\167\316\360\241\313\227\070\261\150\014\154\033"
	"\037\244\314\103\171\351\314\044\221\050\303\112\344\337\363\055"
	"\156\175\302\026\054\074\210\126\031\325\336\177\165\111\354\344"
	"\052\036\364\262\267\100\212\070\233\063\220\317\133\201\372\227"
	"\174\345\025\317\230\146\320\000\000\377\240\332\075\276\060\155"
	"\335\331\253\240\125\366\033\277\210\360\102\072\000\111\051\313"
	"\167\224\224\154\340\372\053\065\362\063\031\172\005\211\331\176"
	"\264\330\074\065\064\355\351\065\257\162\074\223\001\334\113\334"
	"\125\143\241\162\245\032\005\320\100\003\166\221\265\206\220\243"
	"\002\332\163\116\121\242\246\304\060\005\066\264\124\133\261\030"
	"\242\120\256\055\314\136\173\162\013\212\230\041\253\267\233\137"
	"\300\313\033\340\177\002\310\073\030\371\116\076\242\277\346\366"
	"\334\106\121\064\314\251\143\220\022\357\114\012\230\077\002\312"
	"\175\334\340\170\241\323\107\332\216\230\134\276\361\032\022\313"
	"\023\237\051\063\267\176\235\233\257\021\254\076\143\271\025\150"
	"\276\020\376\376\225\362\254\340\336\166\013\334\214\035\173\374"
	"\074\155\252\045\264\364\157\231\205\240\071\052\071\136\363\022"
	"\263\207\076\341\336\340\356\067\054\124\377\346\251\220\234\156"
	"\306\044\101\366\010\376\254\107\353\160\116\233\263\302\076\054"
	"\063\120\006\223\172\050\266\361\221\172\301\112\150\352\070\340"
	"\342\023\377\234\034\175\154\351\014\016\332\363\311\265\321\250"
	"\220\205\043\045\002\223\052\351\373\267\017\367\116\172\230\234"
	"\001\365\104\014\044\311\346\206\336\110\013\340\200\225\170\353"
	"\303\063\221\210\320\301\023\040\204\172\032\176\072\276\130\021"
	"\170\252\302\026\272\157\206\225\063\023\361\226\064\361\004\006"
	"\142\106\110\343\105\102\054\161\235\103\124\375\255\330\124\054"
	"\174\045\370\120\167\167\306\221\257\142\155\366\174\340\050\375"
	"\133\040\333\216\210\135\355\104\104\346\346\034\212\051\307\112"
	"\345\262\362\073\323\342\157\343\261\214\047\057\172\164\343\174"
	"\077\367\261\147"
#define      msg2_z	19
#define      msg2	((&data[2301]))
	"\264\152\157\327\175\111\234\135\137\157\322\060\320\157\102\024"
	"\327\200\016\314\222\151\315\324"
#define      inlo_z	3
#define      inlo	((&data[2322]))
	"\347\073\272"
#define      rlax_z	1
#define      rlax	((&data[2325]))
	"\114"
#define      lsto_z	1
#define      lsto	((&data[2326]))
	"\036"
#define      opts_z	1
#define      opts	((&data[2327]))
	"\036"
#define      chk2_z	19
#define      chk2	((&data[2332]))
	"\210\033\366\367\267\250\047\267\266\322\011\217\217\217\007\375"
	"\336\351\246\330\354\374\306\332\203\205"/* End of data[] */;
#define      hide_z	4096
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask  = (unsigned long)&chkenv;
	mask ^= (unsigned long)getpid() * ~mask;
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
#	define PTRACE_ATTACH	PT_ATTACH
#endif
void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PTRACE_ATTACH, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = getenv("_");
	if (me == NULL) { me = argv[0]; }

	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	ret = chkenv(argc);
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
