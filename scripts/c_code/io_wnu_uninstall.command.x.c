#if 0
	shc Version 3.9.3a3, Generic Shell Script Compiler
	GNU GPL Version 3 Fedor Mankov <envieidoc@gmail.com>

	./shc -v -r -f io_wnu_uninstall.command 
#endif

static  char data [] = 
#define      inlo_z	3
#define      inlo	((&data[0]))
	"\150\103\216"
#define      pswd_z	256
#define      pswd	((&data[41]))
	"\054\343\372\131\015\007\163\024\176\105\314\004\226\240\257\047"
	"\264\032\057\047\322\057\364\004\112\013\362\211\143\070\161\366"
	"\244\233\024\143\260\147\357\244\207\302\144\055\234\127\053\145"
	"\207\261\011\201\044\146\024\226\215\336\234\130\224\147\016\114"
	"\051\272\342\014\335\151\210\357\274\064\142\024\357\370\251\275"
	"\141\050\000\024\035\261\060\365\367\242\236\254\353\332\302\100"
	"\225\057\304\365\122\345\023\310\344\346\374\373\277\203\362\327"
	"\075\254\243\156\077\257\112\057\052\276\033\324\310\245\034\121"
	"\044\031\202\200\372\140\000\100\332\304\176\344\330\261\041\107"
	"\236\046\306\250\244\003\322\365\314\176\025\225\342\275\252\020"
	"\314\344\034\156\111\071\305\215\123\353\351\203\152\013\336\017"
	"\247\015\152\100\231\261\246\037\337\034\003\376\120\010\250\355"
	"\065\244\302\356\231\101\117\265\207\250\252\146\374\334\220\314"
	"\363\370\352\236\043\100\165\367\212\123\056\214\266\006\312\021"
	"\357\303\311\352\156\324\164\261\133\121\162\121\305\102\153\052"
	"\125\171\133\072\304\023\240\043\125\374\103\127\110\172\370\343"
	"\225\211\116\370\344\047\235\220\230\033\373\174\343\345\127\324"
	"\052\155\013\033\166\037\350\376\127\045\160\325\116\060\323\223"
	"\335\057\366\322\347\127\125\121\254\155\326\034\030\235\332\257"
	"\351\141\117\347\020\357\144\361\316\204\132\073\175\106\350\363"
	"\206\251\056\343\234\120\256\273\146\004\220\271\157\354\323\172"
	"\232\007\106\332\375\342\271\247\067\242\323\313\151\060\064"
#define      lsto_z	1
#define      lsto	((&data[354]))
	"\100"
#define      date_z	1
#define      date	((&data[355]))
	"\072"
#define      msg2_z	19
#define      msg2	((&data[357]))
	"\214\205\071\054\140\326\173\071\355\311\063\234\204\216\016\110"
	"\360\352\055\356\034\054\360"
#define      chk2_z	19
#define      chk2	((&data[382]))
	"\340\104\054\067\037\223\275\320\032\177\347\015\165\334\073\300"
	"\046\011\254\161\316\013\315\343\303"
#define      tst1_z	22
#define      tst1	((&data[407]))
	"\026\272\211\320\360\131\014\342\375\034\321\074\301\236\144\016"
	"\340\172\171\033\320\374\307\341\260\235"
#define      tst2_z	19
#define      tst2	((&data[433]))
	"\261\162\022\053\166\230\174\122\245\267\125\005\123\167\167\206"
	"\052\262\037\072\347\372\345\047"
#define      xecc_z	15
#define      xecc	((&data[456]))
	"\043\135\142\315\110\352\100\304\371\276\152\070\374\336\233\343"
	"\347\002\142\116"
#define      chk1_z	22
#define      chk1	((&data[475]))
	"\301\156\230\264\157\137\204\341\125\055\326\350\272\014\026\346"
	"\236\222\340\053\155\006\307\340"
#define      shll_z	10
#define      shll	((&data[498]))
	"\052\257\133\057\014\306\165\212\363\115\243\044"
#define      rlax_z	1
#define      rlax	((&data[510]))
	"\234"
#define      opts_z	1
#define      opts	((&data[511]))
	"\022"
#define      text_z	1249
#define      text	((&data[765]))
	"\111\316\160\231\270\013\310\112\366\265\345\130\060\351\022\114"
	"\245\306\123\206\123\102\136\305\065\126\235\312\261\127\333\272"
	"\052\125\351\023\135\353\115\304\340\272\341\236\331\270\116\201"
	"\225\157\010\254\212\156\373\171\265\167\044\073\152\212\040\143"
	"\111\143\220\034\316\141\020\177\221\160\305\124\275\365\035\236"
	"\331\137\363\266\073\214\012\154\243\220\142\214\337\322\120\163"
	"\072\304\047\123\272\232\270\120\153\023\214\030\271\020\135\047"
	"\065\301\024\030\247\306\350\055\331\062\075\246\121\151\373\377"
	"\234\135\161\133\300\156\063\043\054\277\353\007\133\352\075\034"
	"\024\022\103\034\210\012\225\160\013\265\145\051\270\317\336\064"
	"\354\043\134\322\252\155\147\111\156\341\076\051\325\030\025\215"
	"\377\334\037\362\373\222\227\353\327\341\161\004\121\255\013\325"
	"\261\330\266\132\225\311\115\233\240\251\111\317\110\366\275\013"
	"\203\005\030\075\144\312\211\053\271\066\235\276\202\313\264\336"
	"\325\333\271\232\330\227\062\110\151\321\203\124\334\327\107\342"
	"\006\062\306\153\302\024\267\122\260\354\236\327\066\243\116\263"
	"\076\155\011\307\211\363\065\201\377\377\067\216\266\132\367\174"
	"\126\210\037\135\205\045\033\176\234\017\153\152\047\266\204\371"
	"\026\246\222\244\154\243\161\210\336\025\356\301\112\367\370\123"
	"\036\127\354\047\267\374\103\151\156\175\057\045\267\165\372\306"
	"\307\030\344\264\012\353\115\353\012\330\025\043\325\322\154\332"
	"\045\315\352\375\075\300\004\222\001\003\163\227\325\106\217\374"
	"\100\357\101\172\056\056\217\302\154\000\364\315\363\121\050\207"
	"\375\255\105\007\026\047\144\003\114\024\237\127\013\257\160\205"
	"\113\146\303\323\061\050\234\257\110\224\174\121\341\106\047\243"
	"\345\370\057\072\230\251\205\365\152\025\234\027\117\155\111\217"
	"\001\357\073\010\302\352\035\136\362\022\211\230\265\203\215\056"
	"\227\356\332\047\305\301\116\246\351\006\061\106\251\245\037\111"
	"\346\372\261\327\007\022\000\302\302\116\225\154\042\241\264\322"
	"\200\307\144\154\210\174\210\042\337\154\141\366\343\103\205\061"
	"\177\124\041\332\330\001\261\350\111\066\237\264\361\050\373\245"
	"\217\020\101\227\153\331\277\352\215\113\214\262\167\023\043\262"
	"\211\135\232\171\276\164\201\240\370\201\063\310\051\010\071\021"
	"\214\157\073\200\356\172\116\234\076\266\150\266\052\064\316\376"
	"\353\370\176\355\325\323\046\003\315\047\131\104\043\337\043\030"
	"\325\001\262\112\077\300\273\202\130\212\007\224\037\116\250\265"
	"\301\223\375\327\235\136\275\221\066\260\244\033\164\311\307\143"
	"\023\233\250\016\211\343\226\335\247\137\062\370\130\360\221\377"
	"\272\067\224\076\031\142\245\120\010\221\123\072\175\051\150\033"
	"\071\235\302\107\273\025\141\165\374\354\304\025\257\270\224\265"
	"\125\043\171\221\054\032\163\040\016\231\106\237\325\134\047\275"
	"\216\343\063\167\306\233\334\322\123\341\047\031\000\370\245\247"
	"\324\225\347\373\031\275\213\365\121\375\335\136\156\061\045\121"
	"\153\200\271\244\246\061\352\065\046\054\175\260\364\227\203\156"
	"\310\335\373\057\067\220\063\132\245\235\010\216\214\075\003\210"
	"\175\234\353\264\240\115\361\374\200\211\015\155\170\352\325\215"
	"\160\254\360\121\257\237\043\330\066\025\252\172\255\263\043\321"
	"\131\004\001\262\142\147\151\360\234\147\363\172\014\001\226\273"
	"\361\335\154\240\000\330\042\253\010\177\251\020\374\014\004\013"
	"\363\145\344\060\304\317\016\345\135\012\060\253\046\220\110\346"
	"\271\233\362\004\027\062\162\365\202\030\132\255\072\011\001\123"
	"\331\052\310\025\250\347\271\364\171\176\312\202\104\205\066\340"
	"\377\263\251\345\074\062\171\353\030\020\255\024\275\106\252\315"
	"\010\067\070\020\356\044\264\374\104\303\042\236\376\373\243\031"
	"\233\363\065\256\275\270\057\234\176\254\300\307\367\060\377\262"
	"\200\347\306\313\127\253\173\056\157\005\216\331\153\044\211\340"
	"\212\301\162\113\133\210\333\274\033\270\174\237\142\135\373\143"
	"\237\017\376\006\124\252\014\013\222\236\211\112\033\317\075\272"
	"\355\151\344\051\017\146\264\274\265\320\170\247\222\274\375\040"
	"\324\121\131\162\147\153\041\350\235\110\152\016\376\045\243\375"
	"\235\245\236\346\041\250\221\112\365\110\315\303\332\246\304\322"
	"\240\001\352\301\325\072\236\107\013\122\322\115\275\167\164\214"
	"\314\226\135\166\306\036\161\226\110\371\061\167\103\046\207\150"
	"\025\102\046\004\111\051\152\151\215\074\114\251\375\277\027\217"
	"\252\167\326\346\221\054\376\313\314\352\020\073\215\157\223\022"
	"\314\073\151\064\110\030\174\071\031\164\001\204\053\115\310\077"
	"\250\033\312\064\015\332\156\302\057\226\201\031\214\107\252\377"
	"\153\264\050\210\373\301\102\270\045\203\161\321\331\133\254\306"
	"\351\221\266\261\374\154\266\241\277\145\133\056\115\135\114\214"
	"\137\143\240\134\052\302\210\233\011\340\163\307\324\105\270\020"
	"\015\056\222\226\020\331\016\177\076\050\061\370\304\203\065\274"
	"\016\314\013\077\337\135\004\141\224\334\013\002\224\352\342\173"
	"\222\203\061\144\041\023\334\220\033\226\316\244\017\367\166\306"
	"\134\205\033\073\230\130\255\270\310\343\162\164\014\372\345\207"
	"\220\247\176\167\023\320\363\051\033\010\033\242\061\112\217\300"
	"\374\203\304\031\377\336\156\100\116\040\362\223\101\027\350\251"
	"\124\003\146\044\367\306\227\305\331\177\246\017\250\056\076\352"
	"\355\171\060\260\344\346\212\044\166\027\202\065\274\271\361\061"
	"\315\036\045\202\325\366\314\261\007\223\120\202\015\125\262\360"
	"\376\352\160\141\122\042\104\266\216\023\215\140\257\120\375\074"
	"\356\300\173\164\172\115\333\176\346\336\051\236\241\372\331\075"
	"\256\125\216\115\072\316\214\230\156\246\124\011\175\141\140\053"
	"\351\261\261\016\236\136\302\133\063\355\332\115\120\141\242\175"
	"\373\133\043\253\007\326\212\274\236\036\317\360\360\244\016\152"
	"\316\376\267\012\235\235\027\212\007\355\103\160\206\160\132\330"
	"\040\376\004\017\134\241\305\203\247\316\303\247\362\230\024\316"
	"\277\027\114\276\027\233\325\131\015\063\237\236\365\257\153\212"
	"\215\225\207\134\204\347\154\227\025\337\212\072\337\035\072\170"
	"\033\337\266\366\145\170\166\100\205\355\321\134\377\366\246\301"
	"\334\057\330\160\143\003\357\350\112\211\257\104\235\174\336\144"
	"\260\204\066\041\066\202\134\271\307\342\005\226\123\051\020\336"
	"\313\213\103\244\336\066\311\111\205\217\206\046\322\065\153\162"
	"\062\271\002\011\147\054\025\122\045\325\342\327\073\256\051\216"
	"\241\277\246\047\333\046\137\237\261\353\274\310\352\004\007\046"
	"\236\017\373\127\211\016\377\326\040\030\027\226\146\020\032\374"
	"\310\054\177\317\140\076\041\155\316\354\361\333\161\141\062\206"
	"\013\224\034\374\072\046\377\105\176\022\017\257\065\327\243\103"
	"\023\176\250\260\346\156\274\100\362\254\345\132\002\177\064\374"
	"\034\021\113\257\313\141\226\124\275\225\360\160\046\207\003\003"
	"\000\275\340\171\302\361\120\033\100\261\170\154\377\326\167\163"
	"\121\276\063\272\063\240\234\364\105\176\305\274\224\204\154\273"
	"\063\207\263\207\120\357\202\143\174\042\136\024\173\163\015\211"
	"\253\075\227\235\021\026\364\016\277\136\027\033\043\067\072\146"
	"\275\373\240\376\157\360"
#define      msg1_z	62
#define      msg1	((&data[2168]))
	"\231\035\220\030\306\231\276\314\377\140\125\173\344\367\002\120"
	"\221\303\156\164\056\150\311\316\140\126\266\277\164\322\170\115"
	"\176\322\234\001\115\377\247\022\050\164\360\153\276\307\142\170"
	"\221\336\067\240\272\034\366\211\121\051\225\235\210\117\127\244"
	"\337\237\117\126\204\162\112\232"/* End of data[] */;
#define      hide_z	4096
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask  = (unsigned long)&chkenv;
	mask ^= (unsigned long)getpid() * ~mask;
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
#	define PTRACE_ATTACH	PT_ATTACH
#endif
void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PTRACE_ATTACH, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = getenv("_");
	if (me == NULL) { me = argv[0]; }

	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	ret = chkenv(argc);
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
