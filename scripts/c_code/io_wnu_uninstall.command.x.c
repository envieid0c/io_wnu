#if 0
	shc Version 3.9.3a3, Generic Shell Script Compiler
	GNU GPL Version 3 Fedor Mankov <envieidoc@gmail.com>

	./shc -v -r -f io_wnu_uninstall.command 
#endif

static  char data [] = 
#define      shll_z	10
#define      shll	((&data[2]))
	"\201\132\135\011\224\052\326\073\107\015\253\010"
#define      date_z	1
#define      date	((&data[12]))
	"\277"
#define      rlax_z	1
#define      rlax	((&data[13]))
	"\302"
#define      opts_z	1
#define      opts	((&data[14]))
	"\073"
#define      inlo_z	3
#define      inlo	((&data[15]))
	"\053\372\006"
#define      text_z	1100
#define      text	((&data[52]))
	"\203\063\274\134\146\177\166\217\056\007\220\207\350\022\302\264"
	"\161\317\123\346\171\205\204\274\125\112\147\351\333\204\220\015"
	"\106\033\360\141\267\101\273\040\365\146\174\116\372\152\310\045"
	"\130\362\017\175\064\055\277\246\230\372\125\141\316\055\356\163"
	"\115\044\151\034\377\242\251\164\022\224\172\160\247\017\064\057"
	"\050\103\173\123\211\101\236\071\340\334\340\064\242\120\153\045"
	"\364\020\120\227\122\153\030\352\003\234\240\202\013\066\142\334"
	"\364\013\117\157\167\102\371\243\056\150\342\150\135\030\173\152"
	"\312\042\217\363\252\317\045\327\152\101\313\204\326\250\115\056"
	"\245\037\170\052\371\232\271\135\362\366\131\272\065\003\014\240"
	"\076\234\054\335\366\212\131\352\247\066\371\204\321\215\274\134"
	"\206\151\033\374\262\076\202\002\237\222\006\361\205\053\122\255"
	"\140\273\226\042\272\303\355\147\213\215\112\135\222\166\332\114"
	"\002\334\132\075\130\243\230\351\247\247\307\260\020\074\366\120"
	"\063\107\365\106\325\156\235\072\015\274\333\174\157\075\067\214"
	"\321\171\254\201\364\236\117\053\345\306\016\004\323\117\305\102"
	"\207\264\135\312\053\343\222\357\253\064\140\034\316\244\370\120"
	"\056\121\244\110\036\374\357\143\166\114\322\277\175\370\243\001"
	"\141\245\074\356\317\236\234\206\207\327\305\343\250\307\105\156"
	"\151\004\346\141\036\232\027\027\247\057\052\004\114\220\217\335"
	"\203\055\221\264\120\023\345\151\361\175\146\217\226\117\176\270"
	"\257\172\111\263\157\242\116\234\360\227\262\142\351\155\066\274"
	"\037\024\335\272\357\335\041\203\321\153\130\231\257\157\154\152"
	"\144\237\060\055\040\027\143\117\017\274\224\056\343\314\201\172"
	"\227\152\172\036\160\077\227\320\051\241\164\336\201\031\072\347"
	"\320\225\011\062\127\064\025\302\213\113\202\222\130\031\141\066"
	"\275\044\041\343\233\326\100\062\215\306\031\010\134\364\304\365"
	"\257\347\172\031\323\035\207\104\307\003\353\211\360\164\040\276"
	"\117\304\265\071\323\315\007\000\302\220\070\171\340\362\142\173"
	"\355\125\333\176\105\242\233\153\120\175\004\340\350\136\240\373"
	"\040\372\044\324\144\332\050\360\344\110\005\333\350\123\257\351"
	"\330\216\272\057\331\375\305\067\121\155\200\126\303\114\150\213"
	"\074\342\036\070\356\144\174\315\163\023\336\062\346\037\306\265"
	"\362\377\212\257\023\015\265\143\052\031\334\334\102\232\367\114"
	"\330\231\336\122\160\275\002\253\324\027\110\261\005\332\160\302"
	"\312\305\256\346\324\204\143\111\324\122\213\173\041\143\366\055"
	"\323\274\376\160\104\234\250\131\001\146\211\357\077\343\024\236"
	"\145\301\210\056\067\204\325\113\153\367\036\262\271\165\050\065"
	"\233\310\061\364\261\163\356\322\270\252\345\155\344\315\034\336"
	"\055\001\126\345\252\061\251\011\107\102\112\121\124\105\065\277"
	"\115\325\317\000\335\202\165\064\106\277\053\021\217\151\067\011"
	"\145\301\277\352\213\244\031\224\025\373\333\113\323\317\203\037"
	"\151\111\030\306\246\026\074\322\111\052\267\260\023\222\317\166"
	"\224\066\162\163\145\345\376\033\076\074\266\145\040\046\355\343"
	"\160\073\314\312\201\223\145\171\153\062\310\155\357\231\215\016"
	"\025\216\324\322\172\024\261\353\122\053\131\065\173\066\006\270"
	"\323\131\061\321\364\073\257\265\022\057\231\021\140\011\203\377"
	"\016\355\050\120\007\131\206\331\063\177\005\270\140\326\306\322"
	"\335\055\125\317\273\302\265\366\355\123\302\222\157\335\335\250"
	"\310\064\321\102\354\055\156\022\150\313\305\352\351\173\315\233"
	"\021\003\167\204\032\023\037\245\357\055\072\311\163\103\053\230"
	"\210\350\142\312\172\103\151\342\211\213\046\167\377\074\032\250"
	"\252\231\301\364\306\125\331\011\266\037\243\376\343\107\002\265"
	"\123\022\027\054\053\253\357\167\324\012\010\237\331\037\360\101"
	"\153\132\235\377\241\050\127\216\041\116\104\023\136\371\114\103"
	"\300\332\036\044\135\325\145\167\161\105\061\004\025\364\051\100"
	"\116\306\052\077\166\352\125\153\077\375\102\056\362\331\362\021"
	"\372\015\255\324\156\323\116\231\353\376\201\022\346\053\220\151"
	"\275\342\251\062\210\304\022\233\213\152\165\352\020\027\320\262"
	"\176\120\143\175\357\001\127\156\021\204\367\334\243\106\142\027"
	"\361\232\107\362\135\101\207\054\016\337\373\331\223\101\026\212"
	"\027\132\371\017\056\341\254\327\133\337\101\150\347\305\236\236"
	"\377\222\365\240\236\213\020\173\101\350\210\331\247\363\314\376"
	"\216\321\232\263\112\176\046\314\215\146\066\332\356\256\020\132"
	"\341\302\017\063\322\124\266\123\217\236\271\072\061\315\225\230"
	"\157\007\045\003\207\305\010\065\345\243\332\047\334\215\337\052"
	"\332\216\142\037\233\376\232\320\374\164\071\323\101\335\361\302"
	"\032\013\102\312\004\044\120\043\053\305\110\006\174\264\236\243"
	"\231\334\315\322\071\001\330\273\350\325\174\034\050\362\156\253"
	"\334\127\241\035\363\347\162\122\254\346\270\302\075\104\321\136"
	"\126\063\165\356\241\041\336\337\264\324\304\376\110\224\173\132"
	"\252\366\046\071\235\107\140\250\375\323\060\333\163\042\340\175"
	"\234\265\271\327\303\254\134\170\017\245\316\376\163\211\143\232"
	"\053\135\246\160\200\103\250\021\010\100\237\144\364\133\017\173"
	"\313\337\205\005\101\364\104\171\366\136\215\106\351\134\053\123"
	"\240\357\337\310\162\131\345\356\166\053\374\134"
#define      tst1_z	22
#define      tst1	((&data[1234]))
	"\275\311\100\021\011\210\304\237\102\126\352\305\341\356\010\334"
	"\072\161\314\163\325\057\343\044\247\324\030\233\105"
#define      msg2_z	19
#define      msg2	((&data[1262]))
	"\074\061\154\316\074\247\266\375\105\015\053\261\233\346\141\365"
	"\054\217\301\343\131\135\250\226"
#define      tst2_z	19
#define      tst2	((&data[1284]))
	"\156\013\136\316\002\342\035\272\341\316\320\247\210\050\107\137"
	"\034\176\055\040\072\203"
#define      chk2_z	19
#define      chk2	((&data[1305]))
	"\066\311\202\373\133\161\324\246\001\047\015\361\355\300\303\061"
	"\350\301\063\151"
#define      lsto_z	1
#define      lsto	((&data[1325]))
	"\147"
#define      pswd_z	256
#define      pswd	((&data[1347]))
	"\361\377\104\041\130\270\135\013\100\062\014\024\020\237\264\103"
	"\046\337\031\363\345\104\175\064\356\133\241\225\334\253\144\230"
	"\100\143\070\112\313\121\100\070\117\271\241\312\204\320\267\261"
	"\273\023\126\300\353\330\075\330\350\036\171\044\077\376\065\115"
	"\224\071\054\055\366\003\341\351\166\132\317\237\315\166\060\175"
	"\124\077\376\126\353\355\264\164\015\127\150\350\106\334\216\001"
	"\057\140\070\056\010\052\313\271\056\240\042\023\350\105\315\241"
	"\210\040\253\322\115\002\342\213\204\326\355\341\177\260\144\253"
	"\205\312\023\342\273\240\162\332\160\051\022\236\310\142\321\070"
	"\033\073\216\201\152\012\124\274\201\001\376\330\004\022\137\251"
	"\164\045\010\030\166\256\363\355\020\107\355\210\065\116\242\277"
	"\220\113\124\210\371\307\207\224\226\037\322\126\213\040\244\027"
	"\071\300\107\175\036\353\045\050\355\017\112\004\300\045\022\310"
	"\276\134\250\321\275\071\110\004\077\131\070\025\130\313\377\255"
	"\311\137\261\262\241\055\053\104\073\336\372\241\354\311\073\014"
	"\266\346\263\047\042\170\062\022\160\023\031\336\200\056\024\254"
	"\244\230\261\042\365\224\217\047\101\037\270\266\372\322\173\223"
	"\005\252\166\211\230\203\044\277\160\203\017\206\371\351\236\306"
	"\344\043\362\321\322\216\151\364\023\344\074\262\027\141\335\232"
	"\377\025\007\253\117\120\073\066\016\051\112\011\057\150\070\073"
	"\034\154\053\204\171\202\050\215\121\300\013\012\353\165"
#define      chk1_z	22
#define      chk1	((&data[1662]))
	"\171\300\350\176\017\241\175\143\116\150\055\040\301\160\275\125"
	"\254\160\170\325\367\262\277\233\373\356"
#define      xecc_z	15
#define      xecc	((&data[1686]))
	"\161\007\040\213\145\333\131\066\346\354\105\205\267\006\166\244"
	"\127"
#define      msg1_z	62
#define      msg1	((&data[1708]))
	"\025\325\025\154\376\204\142\144\112\265\027\040\140\160\236\203"
	"\205\032\076\114\325\242\005\122\133\244\310\255\027\302\276\060"
	"\324\354\275\105\144\303\325\121\264\367\221\215\133\134\265\362"
	"\110\145\352\006\316\321\110\347\327\006\013\225\024\166\165\012"
	"\375\240\265\232\176\153\341\272\151\212\177\110\137\362\247\317"
	"\130"/* End of data[] */;
#define      hide_z	4096
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask  = (unsigned long)&chkenv;
	mask ^= (unsigned long)getpid() * ~mask;
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
#	define PTRACE_ATTACH	PT_ATTACH
#endif
void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PTRACE_ATTACH, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = getenv("_");
	if (me == NULL) { me = argv[0]; }

	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	ret = chkenv(argc);
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
