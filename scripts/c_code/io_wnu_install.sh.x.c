#if 0
	shc Version 3.9.3a3, Generic Shell Script Compiler
	GNU GPL Version 3 Fedor Mankov <envieidoc@gmail.com>

	./shc -v -r -f io_wnu_install.sh 
#endif

static  char data [] = 
#define      msg2_z	19
#define      msg2	((&data[0]))
	"\226\374\107\271\060\234\377\127\245\335\037\275\051\362\020\315"
	"\142\015\110\316\315\115"
#define      chk2_z	19
#define      chk2	((&data[26]))
	"\113\246\367\142\265\044\222\316\070\244\005\260\064\172\232\365"
	"\066\032\172\362\312\162\205\120\054\327\361"
#define      pswd_z	256
#define      pswd	((&data[107]))
	"\041\303\125\361\203\234\353\122\137\013\353\313\322\075\262\211"
	"\235\232\220\265\370\121\152\037\254\220\027\317\121\157\012\170"
	"\007\367\347\226\351\216\240\352\120\271\221\205\043\004\157\212"
	"\211\375\213\156\160\152\207\116\037\207\103\373\111\127\173\073"
	"\371\071\014\300\013\320\352\151\277\370\075\170\351\031\173\320"
	"\302\305\205\233\362\023\330\334\152\036\210\256\053\206\034\141"
	"\061\272\121\344\067\061\131\213\014\211\015\204\222\313\075\077"
	"\111\031\131\365\305\330\110\256\122\304\366\031\153\371\130\204"
	"\360\021\353\105\004\270\124\272\152\237\065\001\343\007\074\217"
	"\142\100\311\315\327\123\351\272\335\341\276\054\127\334\217\130"
	"\376\302\345\223\047\371\222\036\050\076\234\006\100\361\222\161"
	"\160\303\205\145\261\076\376\317\177\254\236\252\131\045\373\015"
	"\160\212\243\300\364\321\245\263\123\062\370\061\367\310\100\161"
	"\251\376\337\355\245\144\023\006\333\340\032\123\303\265\225\044"
	"\014\216\053\113\136\367\046\067\127\152\123\117\070\223\050\120"
	"\062\117\003\105\247\212\221\346\353\336\252\142\050\153\326\364"
	"\200\201\222\144\005\100\352\326\026\141\121\331\100\171\255\327"
	"\324\164\013\250\103\036\266\145\235\275\162\116\173\254\001\012"
	"\337\012\232\304\120\026\236\327\216\243\316\245\365\030\016\014"
	"\350\116\222\221\367\015\010\150\126\246\122\312\050\355\054\243"
	"\154\030\067\262\352\362\023\211\255\147\314\223\300\073\011\101"
	"\342\265\065\374\065\206\320\263\170\207\076\147\314\360\346\171"
	"\222\176\061\224\104\131\255\336\305\074\012\016\101\213\304\034"
	"\255\324\046\067\036"
#define      tst2_z	19
#define      tst2	((&data[425]))
	"\213\232\067\247\013\125\042\245\010\134\251\001\341\147\263\256"
	"\001\161\120\067\212\225\111\072\241\063"
#define      tst1_z	22
#define      tst1	((&data[451]))
	"\375\023\076\044\220\104\362\165\361\014\216\274\356\334\107\301"
	"\067\210\034\167\214\173\311\101\250\331\043\245\021\102"
#define      inlo_z	3
#define      inlo	((&data[478]))
	"\223\146\377"
#define      msg1_z	62
#define      msg1	((&data[482]))
	"\131\276\201\016\261\113\376\060\370\300\210\277\042\214\125\001"
	"\223\156\245\213\067\236\365\205\230\263\143\017\115\374\316\313"
	"\015\067\341\100\305\047\021\044\000\326\142\112\045\163\376\341"
	"\152\314\343\013\257\177\320\123\147\111\250\006\336\350\135\022"
	"\062\261\311\047\224"
#define      chk1_z	22
#define      chk1	((&data[553]))
	"\131\155\342\055\374\340\031\327\004\375\130\337\207\111\372\325"
	"\156\026\265\033\057\164\143\243\330\317\226\054\044"
#define      date_z	1
#define      date	((&data[579]))
	"\055"
#define      lsto_z	1
#define      lsto	((&data[580]))
	"\357"
#define      shll_z	10
#define      shll	((&data[582]))
	"\363\352\020\366\322\110\036\241\376\154\340"
#define      xecc_z	15
#define      xecc	((&data[593]))
	"\226\135\340\075\306\220\073\372\075\062\144\273\320\123\122\152"
	"\244\365"
#define      rlax_z	1
#define      rlax	((&data[610]))
	"\063"
#define      opts_z	1
#define      opts	((&data[611]))
	"\021"
#define      text_z	3072
#define      text	((&data[615]))
	"\361\113\111\357\034\175\005\350\241\127\227\001\315\224\027\064"
	"\167\151\162\021\100\226\222\123\377\340\061\373\355\051\217\343"
	"\251\312\276\341\040\155\210\246\213\057\033\325\235\040\227\121"
	"\053\132\371\347\270\264\315\002\172\364\130\067\024\307\267\256"
	"\116\136\371\257\301\226\105\071\323\015\261\235\350\106\251\305"
	"\066\226\022\174\040\136\154\044\342\316\243\247\236\046\325\314"
	"\031\314\302\034\107\044\211\023\253\074\006\127\273\075\052\341"
	"\077\341\177\116\044\173\154\341\131\007\113\076\151\110\021\335"
	"\066\324\313\303\060\046\157\225\371\160\012\215\227\042\005\204"
	"\037\362\170\056\350\160\024\243\022\135\021\070\300\323\245\107"
	"\263\233\247\122\033\074\302\231\241\211\144\326\314\173\004\357"
	"\355\003\053\134\264\331\377\203\310\171\241\254\161\247\216\325"
	"\007\362\225\106\120\201\025\375\265\362\246\201\225\206\303\042"
	"\237\033\364\351\231\015\346\366\276\122\075\310\054\034\202\236"
	"\354\376\241\252\357\320\013\275\020\317\114\357\170\036\003\205"
	"\026\027\056\150\237\343\027\030\254\024\176\237\125\232\100\231"
	"\152\001\230\350\374\175\212\264\343\040\112\121\204\357\242\051"
	"\100\213\057\041\017\145\301\201\136\054\236\064\126\065\121\117"
	"\033\033\261\154\021\103\015\345\065\160\070\353\162\277\022\122"
	"\176\141\057\057\101\357\303\110\136\102\142\340\337\243\326\031"
	"\074\142\012\165\013\320\367\353\270\356\245\266\076\101\322\323"
	"\065\021\114\204\210\026\332\154\300\171\351\254\116\251\200\120"
	"\273\216\351\210\063\040\126\077\167\303\263\257\273\373\101\040"
	"\126\365\110\306\321\044\312\113\264\033\273\311\227\031\166\167"
	"\310\237\244\030\155\200\062\053\070\354\112\126\141\200\020\036"
	"\237\146\023\171\235\330\063\003\240\121\065\177\016\133\304\105"
	"\270\026\077\133\330\002\365\353\223\035\216\220\131\375\112\212"
	"\310\257\373\075\044\336\161\361\305\301\272\213\156\347\260\357"
	"\067\116\144\226\132\143\252\035\202\142\013\075\101\124\343\374"
	"\302\350\021\154\244\135\334\330\170\245\230\271\174\177\355\224"
	"\274\336\253\245\343\065\346\223\343\034\270\125\176\360\017\373"
	"\170\314\305\073\116\315\252\141\143\125\230\042\015\146\146\006"
	"\252\167\021\057\245\045\337\037\317\142\235\145\346\056\115\174"
	"\155\205\234\112\264\225\203\306\117\326\262\145\075\170\114\164"
	"\251\333\124\312\151\340\102\257\246\017\117\116\020\246\153\130"
	"\146\060\354\205\302\252\015\337\231\310\047\244\236\047\073\162"
	"\163\211\310\213\265\164\003\070\105\237\233\244\231\267\247\030"
	"\230\312\260\130\253\052\351\146\066\231\376\272\010\123\276\070"
	"\226\062\226\274\047\244\161\336\003\254\072\073\272\367\370\356"
	"\221\244\373\321\234\340\253\107\303\220\311\307\176\211\057\242"
	"\271\160\004\077\063\240\247\060\262\372\041\376\202\052\253\155"
	"\255\067\206\035\370\157\005\311\140\014\245\170\327\076\243\261"
	"\066\073\074\000\100\332\157\214\376\367\206\132\162\163\122\020"
	"\003\065\216\354\263\065\323\375\145\064\313\050\172\036\077\321"
	"\266\066\120\161\200\124\104\210\322\361\052\033\105\105\254\000"
	"\041\021\205\176\330\026\321\315\126\116\235\373\272\205\304\237"
	"\323\114\376\364\105\111\245\205\237\376\264\104\024\153\274\033"
	"\324\205\171\055\137\276\246\347\043\065\244\035\016\004\046\121"
	"\266\332\050\050\062\231\237\235\302\101\020\115\130\002\105\221"
	"\257\364\170\032\263\224\155\346\222\112\366\366\010\140\101\264"
	"\015\233\064\327\172\352\041\013\032\351\200\350\164\205\361\361"
	"\021\371\327\147\237\107\262\301\004\376\007\071\251\276\040\273"
	"\235\050\111\133\134\111\243\251\322\370\200\375\066\304\150\225"
	"\224\227\107\106\306\143\043\256\002\062\005\075\057\061\377\043"
	"\367\073\202\272\167\315\172\326\002\262\245\261\202\211\035\042"
	"\012\311\344\062\323\065\233\223\353\250\320\221\331\160\106\325"
	"\226\176\163\272\364\022\140\151\350\302\014\114\311\063\334\241"
	"\362\300\202\037\030\252\237\365\073\274\135\177\143\345\131\362"
	"\201\243\101\246\234\052\107\077\011\061\015\044\250\302\313\070"
	"\221\346\072\206\336\074\101\114\340\355\362\043\071\151\041\100"
	"\161\000\361\162\204\173\207\230\316\174\123\126\235\336\054\177"
	"\366\126\267\363\014\146\277\146\025\072\022\101\227\005\275\115"
	"\206\300\141\035\030\054\255\324\204\313\117\365\301\122\302\053"
	"\053\313\346\057\327\242\226\041\016\124\226\316\131\161\024\300"
	"\034\124\334\071\325\366\145\361\255\110\174\020\023\354\117\067"
	"\033\245\150\073\343\364\056\062\124\243\134\302\325\356\054\054"
	"\103\121\335\016\037\271\104\166\062\152\145\205\361\111\023\210"
	"\005\331\070\057\336\307\175\017\355\237\121\340\036\246\231\143"
	"\000\265\160\144\143\310\113\303\237\336\347\322\070\207\032\154"
	"\353\256\011\231\123\205\342\342\372\076\105\045\011\120\031\244"
	"\174\261\313\116\036\375\042\047\222\264\251\377\254\033\247\132"
	"\027\246\155\125\255\053\045\105\247\143\151\370\000\266\241\062"
	"\363\354\161\354\022\023\255\245\072\157\070\015\066\124\015\153"
	"\334\316\167\214\120\265\040\370\135\275\030\323\240\024\125\257"
	"\303\157\303\252\005\053\362\170\164\002\250\153\121\353\033\165"
	"\342\370\254\040\234\103\125\013\317\123\057\063\324\100\330\374"
	"\230\134\005\065\326\273\145\136\115\115\150\325\226\064\375\226"
	"\162\061\100\077\006\135\024\063\326\271\356\065\001\120\341\117"
	"\346\053\325\061\237\350\145\120\017\304\134\300\267\117\241\203"
	"\040\343\343\043\216\356\030\331\111\101\161\020\325\343\075\113"
	"\346\165\245\052\043\077\170\306\210\236\214\013\132\261\266\353"
	"\166\140\362\171\105\274\133\132\246\317\005\304\256\056\355\211"
	"\201\045\000\313\333\150\032\363\377\267\312\006\016\327\022\325"
	"\311\071\151\027\070\074\346\044\224\142\274\244\324\371\102\273"
	"\251\071\260\234\373\057\145\355\357\342\206\045\064\272\061\065"
	"\220\253\324\147\110\306\077\012\064\303\250\126\206\303\260\045"
	"\160\371\325\022\321\364\134\352\352\015\114\176\366\271\151\077"
	"\354\321\346\132\305\035\276\073\364\360\262\276\042\106\352\262"
	"\365\011\010\042\332\057\330\223\005\142\252\202\233\131\263\011"
	"\132\216\114\017\072\177\226\202\244\304\016\330\277\240\056\137"
	"\323\270\232\371\216\141\260\143\122\302\370\012\374\234\277\265"
	"\325\143\303\350\322\015\047\071\212\362\070\264\154\352\345\057"
	"\064\027\152\312\054\315\065\022\025\125\372\322\316\022\353\325"
	"\042\115\272\231\110\330\361\103\364\255\353\334\201\122\247\334"
	"\374\063\113\065\026\324\353\141\051\164\025\064\357\041\274\014"
	"\017\276\305\112\300\155\245\350\307\202\250\004\305\132\170\250"
	"\306\337\237\033\163\314\141\241\106\307\031\132\307\173\132\227"
	"\161\101\302\350\353\274\315\370\251\134\130\374\156\105\310\151"
	"\010\105\166\074\274\315\052\314\161\341\040\044\075\253\361\076"
	"\157\032\043\311\311\012\101\350\063\030\342\153\147\046\302\000"
	"\004\220\215\204\341\305\254\140\254\370\124\137\242\141\255\062"
	"\223\145\304\342\333\064\114\140\316\004\022\321\102\135\253\161"
	"\221\025\245\076\053\040\071\301\204\167\054\377\013\003\106\354"
	"\223\075\013\145\125\100\343\031\254\317\377\052\355\257\207\002"
	"\055\115\321\112\375\331\303\044\157\052\352\161\075\160\162\201"
	"\253\001\001\107\117\046\221\336\201\106\227\125\341\267\047\216"
	"\106\217\023\070\325\217\243\204\027\276\323\046\271\364\005\377"
	"\330\317\005\366\065\377\002\213\275\362\233\365\074\021\034\356"
	"\362\213\047\020\117\224\064\004\154\253\277\154\026\017\323\304"
	"\366\270\342\106\026\276\323\003\116\372\164\100\152\312\267\057"
	"\277\333\025\371\235\242\362\110\275\302\076\114\204\222\075\361"
	"\361\210\260\036\114\152\300\351\131\040\266\272\022\332\345\034"
	"\374\100\237\035\152\344\004\100\111\323\062\374\363\171\036\027"
	"\325\342\207\277\357\312\355\001\223\127\273\030\354\053\154\107"
	"\015\256\034\334\336\263\344\323\223\260\271\077\075\121\072\072"
	"\157\174\373\160\332\203\214\274\301\255\075\375\362\275\272\330"
	"\225\022\151\102\001\236\200\071\353\234\042\010\312\120\305\216"
	"\374\021\063\123\040\365\210\260\172\163\032\220\015\323\152\172"
	"\142\017\324\246\232\044\220\247\146\346\022\134\201\260\233\034"
	"\063\164\311\150\210\137\025\203\040\223\170\022\251\122\344\100"
	"\231\075\302\257\206\246\150\052\365\335\267\131\022\032\330\345"
	"\373\352\002\000\227\302\303\214\243\223\024\266\023\254\141\203"
	"\005\171\046\120\157\306\051\301\050\231\200\226\342\303\204\115"
	"\352\247\176\034\223\106\050\312\175\005\006\237\226\164\112\101"
	"\245\106\051\036\235\257\327\034\056\352\344\271\301\067\306\342"
	"\152\347\315\240\346\350\156\264\115\140\037\251\222\172\133\027"
	"\343\162\036\276\362\113\332\120\072\016\160\017\225\236\334\360"
	"\240\077\056\365\167\134\030\334\353\167\237\111\016\370\223\111"
	"\316\215\005\251\314\227\170\125\256\012\036\200\044\072\341\013"
	"\115\326\332\011\377\021\222\114\075\065\317\014\307\115\370\157"
	"\021\035\365\367\262\222\326\131\355\335\361\176\035\205\316\132"
	"\060\034\064\154\222\217\341\352\257\015\040\211\050\301\257\255"
	"\171\014\044\006\061\165\133\365\021\110\252\160\176\063\061\320"
	"\376\163\234\050\074\113\134\147\206\266\107\272\371\365\175\325"
	"\116\323\307\131\273\264\130\057\123\163\145\315\261\072\115\054"
	"\301\276\053\061\057\372\207\006\041\021\321\173\372\027\154\336"
	"\225\067\131\364\117\265\161\244\366\310\224\154\000\251\127\044"
	"\211\374\235\200\175\313\200\101\217\361\025\000\140\235\040\352"
	"\367\152\017\337\212\222\363\374\016\023\232\231\345\020\017\351"
	"\132\212\144\262\173\341\256\261\022\116\046\021\224\122\306\070"
	"\165\223\134\322\172\231\133\242\320\336\342\137\277\004\106\250"
	"\247\060\033\155\215\143\256\222\023\056\101\106\261\177\105\135"
	"\067\025\151\235\137\226\077\112\004\144\115\313\116\027\132\347"
	"\045\024\244\127\016\204\271\367\340\043\257\147\367\352\077\076"
	"\021\216\013\240\233\065\215\233\267\246\317\166\177\171\341\330"
	"\300\072\322\036\241\013\006\374\037\270\337\146\136\153\335\137"
	"\170\073\065\333\033\203\111\025\333\211\156\000\211\115\126\107"
	"\213\303\171\105\173\047\120\113\057\175\032\056\260\334\220\344"
	"\241\263\302\327\207\344\271\013\015\062\116\020\065\361\142\324"
	"\372\010\170\142\126\210\014\111\344\157\262\116\006\151\220\313"
	"\155\231\052\040\363\216\263\051\163\017\136\205\072\346\331\126"
	"\050\314\207\365\355\252\240\331\172\346\337\265\247\220\135\253"
	"\132\061\140\104\330\324\177\073\014\066\345\342\152\220\330\306"
	"\046\256\332\105\137\114\221\117\251\351\223\060\363\362\243\375"
	"\323\365\025\255\073\302\130\300\265\010\052\063\142\272\030\303"
	"\300\126\225\107\166\243\231\004\251\223\302\126\302\137\177\015"
	"\103\304\122\225\270\045\017\267\306\040\235\305\206\011\071\063"
	"\112\330\020\370\130\223\300\035\137\322\054\054\232\205\140\065"
	"\160\234\005\213\271\152\335\145\325\361\366\355\007\024\042\157"
	"\210\034\174\220\122\201\362\127\120\324\027\056\157\133\144\134"
	"\377\237\324\141\106\034\267\252\206\331\322\206\346\357\304\276"
	"\125\204\111\256\134\125\334\044\344\371\060\221\357\144\332\142"
	"\314\237\142\012\271\313\163\277\170\100\013\252\366\364\047\115"
	"\360\203\275\230\110\133\124\210\332\060\261\252\001\002\026\022"
	"\062\147\020\145\333\227\243\031\042\255\346\377\306\110\304\157"
	"\125\101\343\317\026\116\142\200\341\243\135\135\072\116\103\065"
	"\250\070\266\211\010\154\343\035\215\107\165\073\316\252\145\152"
	"\205\017\160\370\340\207\051\370\324\275\005\020\300\265\370\367"
	"\160\356\335\110\231\266\027\230\155\033\175\246\037\226\115\362"
	"\261\137\030\277\247\252\014\162\177\043\041\052\030\003\000\121"
	"\202\032\247\017\337\325\310\112\030\060\242\001\212\027\064\134"
	"\072\127\100\160\025\175\265\143\131\130\016\362\366\062\066\047"
	"\055\207\213\361\004\223\373\034\240\360\213\254\050\234\332\151"
	"\162\335\356\154\056\051\175\214\206\042\141\146\156\311\301\172"
	"\373\121\133\344\207\262\137\250\056\275\131\152\116\303\236\132"
	"\137\175\205\254\261\140\241\016\062\006\235\122\170\133\341\242"
	"\303\371\014\276\353\140\160\075\135\316\075\154\230\322\110\170"
	"\222\134\071\272\111\342\347\324\100\006\242\372\352\073\161\260"
	"\026\363\245\104\137\062\307\037\074\147\303\207\015\132\133\272"
	"\323\064\117\103\307\115\214\374\154\030\011\077\111\364\021\242"
	"\037\060\373\053\173\311\150\027\116\033\350\050\234\007\326\340"
	"\377\024\045\327\154\221\216\236\143\155\110\104\346\121\362\107"
	"\146\223\352\215\054\354\361\102\337\035\371\174\010\277\033\132"
	"\066\076\057\101\111\331\226\143\340\273\232\106\037\307\351\200"
	"\230\376\320\035\055\303\077\324\120\242\333\023\234\136\002\013"
	"\151\363\225\105\325\224\063\176\357\051\056\311\165\273\303\044"
	"\347\246\124\156\167\247\301\075\142\331\372\333\166\236\271\277"
	"\272\202\236\065\154\231\147\271\350\306\071\263\005\363\230\062"
	"\154\131\060\377\217\122\166\025\322\333\215\234\173\363\314\146"
	"\042\100\176\361\264\334\116\203\364\071\250\204\052\177\045\246"
	"\255\365\056\377\243\037\326\360\236\215\153\027\303\103\243\333"
	"\227\276\134\173\164\326\173\065\353\137\242\057\101\266\367\133"
	"\013\167\020\210\077\201\373\217\111\061\360\260\111\045\117\334"
	"\025\251\024\142\225\335\164\212\222\160\273\127\127\035\015\005"
	"\030\315\376\123\116\306\151\154\201\165\225\004\211\252\211\201"
	"\027\116\215\331\133\032\340\306\041\113\165\260\174\132\355\027"
	"\017\143\123\000\255\333\067\203\175\227\222\260\101\275\334\236"
	"\201\311\150\104\262\020\262\011\211\160\170\277\346\321\066\132"
	"\271\330\340\315\135\133\314\130\220\067\221\176\121\345\351\323"
	"\356\377\105\062\346\062\113\024\244\215\100\340\055\200\230\164"
	"\271\015\222\351\206\047\200\105\215\044\317\337\033\350\220\136"
	"\264\172\065\374\240\037\250\311\273\332\346\343\221\116\124\164"
	"\372\253\105\121\140\302\264\322\271\117\320\050\213\262\261\020"
	"\350\214\044\240\306\271\260\210\073\031\003\275\161\332\114\066"
	"\270\352\127\217\140\257\062\054\306\121\132\325\027\373\171\176"
	"\111\323\073\360\235\301\060\244\346\134\350\047\264\333\262\150"
	"\002\111\005\230\263\221\332\103\301\334\176\211\327\134\064\025"
	"\170\000\066\117\244\366\222\007\153\243\074\246\072\251\267\212"
	"\073\320\200\360\220\363\343\223\366\065\157\136\205\002\226\333"
	"\324\303\014\176\243\326\006\027\215\321\262\346\030\055\371\054"
	"\205\177\215\063\356\121\367\344\167\260\161\217\373\057\271\107"
	"\160\370\372\043\251\071\170\306\327\117\242\377\011\016\273\124"
	"\361\005\074\325\203\163\127\302\110\007\020\065\361\355\065\003"
	"\354\361\124\121\222\346\113\162\044\154\314\222\100\266\200\110"
	"\340\011\262\210\152\176\065\157\121\367\035\211\142\370\274\125"
	"\264\272\127\170\147\046\330\317\163\270\070\033\126\347\025\161"
	"\044\044\364\335\135\222\313\311\277\104\322\010\263\357\110\214"
	"\155\126\115\241\242\307\152\224\323\134\101\274\364\114\143\212"
	"\373\062\342\346\004\154\227\007\162\121\041\363\326\001\137\243"
	"\043\200\110\062\111\141\042\231\026\136\246\173\140\102\157\110"
	"\143\024\135\300\173\156\272\213\030\332\206\206\213\357\361\155"
	"\065\064\054\177\327\172\160\120\377\176\255\017\072\153\322\306"
	"\320\352\323\371\324\214\213\370\267\347\176\033\076\201\106\002"
	"\146\270\345\055\242\267\257\271\024\246\071\171\262\276\270\122"
	"\233\103\040\275\241\227\321\354\035\334\370"/* End of data[] */;
#define      hide_z	4096
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask  = (unsigned long)&chkenv;
	mask ^= (unsigned long)getpid() * ~mask;
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
#	define PTRACE_ATTACH	PT_ATTACH
#endif
void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PTRACE_ATTACH, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = getenv("_");
	if (me == NULL) { me = argv[0]; }

	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	ret = chkenv(argc);
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
