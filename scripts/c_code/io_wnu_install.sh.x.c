#if 0
	shc Version 3.8.9b, Generic Script Compiler
	Copyright (c) 1994-2015 Francisco Rosales <frosal@fi.upm.es>

	./shc -v -r -T -f io_wnu_install.sh 
#endif

static  char data [] = 
#define      msg2_z	19
#define      msg2	((&data[0]))
	"\212\266\341\003\303\230\171\146\254\315\171\020\067\066\067\321"
	"\306\334\032"
#define      date_z	1
#define      date	((&data[19]))
	"\076"
#define      chk2_z	19
#define      chk2	((&data[22]))
	"\252\052\261\013\330\155\306\117\072\160\353\117\371\216\110\355"
	"\316\255\331\174\201"
#define      pswd_z	256
#define      pswd	((&data[59]))
	"\147\005\240\070\075\334\145\260\047\316\042\012\014\133\046\107"
	"\331\355\131\276\244\004\313\215\020\242\010\230\332\225\140\163"
	"\270\113\325\171\323\133\372\375\001\025\220\300\354\220\144\000"
	"\073\163\031\072\147\166\214\033\372\106\066\127\046\350\013\264"
	"\243\216\274\055\224\175\242\154\034\340\173\237\125\077\075\241"
	"\034\306\042\222\170\322\376\011\302\217\360\053\321\003\312\221"
	"\273\251\166\046\312\113\377\340\311\066\056\352\236\215\154\236"
	"\076\057\102\125\220\030\361\327\377\321\172\012\076\321\371\312"
	"\243\163\006\131\357\354\103\302\371\273\177\147\047\161\163\243"
	"\310\126\174\141\262\357\065\163\171\371\142\106\131\077\163\161"
	"\065\250\024\015\274\056\264\327\140\021\203\237\271\256\121\145"
	"\277\002\354\174\056\126\377\300\325\054\224\204\154\036\046\070"
	"\261\340\155\330\011\235\321\273\151\117\223\321\135\000\246\274"
	"\210\335\265\075\127\057\211\360\123\256\172\146\102\272\314\017"
	"\273\277\150\266\215\272\204\370\123\113\273\202\231\201\144\245"
	"\055\214\161\007\223\151\044\040\021\350\132\212\236\347\350\037"
	"\230\033\012\362\236\262\266\137\241\030\044\313\246\144\152\277"
	"\005\026\127\301\264\210\216\254\232\212\012\021\142\000\041\272"
	"\162\376\306\050\316\304\134\126\070\161\217\005\317\303\315\173"
	"\331\071\023\173\333\160\246\242\022\030"
#define      rlax_z	1
#define      rlax	((&data[355]))
	"\357"
#define      shll_z	10
#define      shll	((&data[356]))
	"\002\310\061\132\167\033\167\125\050\226"
#define      inlo_z	3
#define      inlo	((&data[366]))
	"\150\220\233"
#define      msg1_z	42
#define      msg1	((&data[373]))
	"\000\077\106\020\137\141\025\046\235\132\163\335\153\363\176\012"
	"\176\144\304\221\317\122\025\270\242\157\331\105\154\110\244\206"
	"\056\216\375\305\007\076\006\055\050\352\225\071\272\136\012\006"
	"\313\173\205"
#define      xecc_z	15
#define      xecc	((&data[420]))
	"\050\327\257\350\167\147\276\232\261\212\240\307\171\172\077\356"
	"\044\103"
#define      lsto_z	1
#define      lsto	((&data[438]))
	"\017"
#define      chk1_z	22
#define      chk1	((&data[442]))
	"\147\073\346\215\340\263\235\061\317\124\223\235\366\143\327\110"
	"\027\226\335\045\110\254\072\117\072\317\057"
#define      text_z	2727
#define      text	((&data[893]))
	"\056\114\002\315\136\070\065\341\217\336\176\204\127\243\370\042"
	"\256\217\136\051\360\122\166\113\047\003\242\366\057\275\314\121"
	"\357\317\137\167\260\277\345\116\220\132\000\331\061\037\331\313"
	"\024\221\274\212\013\121\276\072\037\273\173\355\122\041\062\254"
	"\047\041\151\306\351\233\364\171\102\062\340\166\167\331\331\340"
	"\030\367\065\325\342\264\066\131\073\004\160\034\130\316\251\120"
	"\226\302\351\320\270\066\323\107\174\363\207\043\116\174\046\072"
	"\226\102\230\175\356\057\105\235\260\300\041\174\140\373\133\127"
	"\110\222\004\041\250\041\365\252\133\234\302\221\025\353\312\143"
	"\156\222\321\117\125\131\155\011\160\260\200\305\373\211\233\164"
	"\327\251\313\013\132\105\250\314\065\266\132\007\035\262\037\327"
	"\013\132\346\073\220\170\133\347\227\342\111\050\302\105\047\104"
	"\321\012\236\370\010\056\273\362\264\122\233\377\326\124\364\040"
	"\300\207\257\211\155\162\205\375\306\341\036\102\016\015\022\026"
	"\276\203\333\246\042\040\126\004\166\220\250\365\305\077\267\110"
	"\322\375\030\134\021\307\350\345\026\062\253\052\046\234\017\147"
	"\266\214\073\004\140\074\041\063\150\001\312\021\320\337\256\230"
	"\271\327\010\011\232\156\114\135\126\023\303\116\134\213\003\052"
	"\365\300\146\204\166\025\071\150\347\135\234\207\051\154\160\116"
	"\103\247\102\037\133\071\301\315\107\153\130\126\344\230\215\277"
	"\326\317\331\276\003\110\150\202\155\214\323\040\075\155\031\031"
	"\342\203\361\005\027\363\364\067\251\110\311\323\237\353\253\354"
	"\033\010\025\075\047\363\072\071\072\104\071\113\343\335\120\070"
	"\027\371\140\255\200\220\243\226\011\216\155\154\332\174\306\301"
	"\146\363\114\361\367\301\014\235\127\043\264\005\070\201\012\210"
	"\245\350\201\117\014\250\345\301\027\161\376\163\336\101\344\310"
	"\126\131\207\010\046\263\164\371\271\015\311\171\203\365\202\035"
	"\216\210\272\146\367\021\325\302\263\162\206\322\153\112\116\062"
	"\257\274\120\100\366\356\365\024\355\023\224\106\101\162\274\040"
	"\362\222\311\144\317\204\263\025\317\010\101\120\154\030\313\210"
	"\315\243\216\310\013\002\321\323\072\054\054\304\161\261\316\110"
	"\165\170\344\156\302\004\052\267\141\153\275\330\310\302\334\074"
	"\267\362\310\154\112\346\061\065\052\073\363\054\152\136\217\352"
	"\152\121\066\234\025\121\031\241\120\162\167\162\022\335\225\244"
	"\307\244\125\110\203\326\355\072\374\122\267\242\300\230\361\273"
	"\362\127\372\321\044\073\320\315\002\327\103\353\010\115\003\027"
	"\021\205\027\212\120\367\247\107\233\260\031\267\321\326\211\243"
	"\061\025\030\000\334\002\150\016\337\373\140\341\130\011\302\067"
	"\063\057\121\300\011\376\176\077\332\326\106\322\010\033\154\242"
	"\245\330\102\254\206\322\022\140\360\232\031\342\231\350\034\246"
	"\305\160\344\362\314\115\142\216\032\104\030\356\346\262\140\226"
	"\214\056\353\132\254\152\247\167\256\214\356\325\301\233\355\004"
	"\263\155\024\223\034\244\103\304\002\060\027\057\311\335\147\163"
	"\221\322\176\122\174\315\257\052\304\350\316\361\315\240\231\035"
	"\102\000\253\175\120\365\366\240\206\342\030\233\241\164\050\366"
	"\176\105\224\000\242\374\241\207\274\272\145\053\223\026\002\341"
	"\177\210\056\364\314\217\316\364\323\121\247\230\207\242\345\331"
	"\040\070\127\362\211\345\311\144\114\330\036\311\173\076\261\213"
	"\373\033\141\164\015\167\352\200\273\163\330\103\043\272\217\112"
	"\322\221\200\333\255\343\302\313\223\137\150\370\164\241\151\244"
	"\201\137\206\275\077\212\363\302\131\072\137\375\152\352\003\306"
	"\224\326\025\227\057\322\354\132\132\171\240\131\306\015\075\071"
	"\065\126\371\031\047\020\021\071\151\232\143\105\271\177\020\335"
	"\271\012\035\026\011\212\114\116\114\157\012\175\264\115\375\021"
	"\224\374\024\276\025\354\015\304\270\032\040\373\205\020\264\347"
	"\315\133\201\316\013\115\122\363\202\267\207\376\111\066\056\330"
	"\345\020\221\146\300\364\075\216\012\217\172\055\071\147\215\300"
	"\224\355\226\325\021\205\266\357\254\077\224\232\370\353\207\073"
	"\024\211\326\007\173\232\327\365\057\350\174\240\364\011\375\306"
	"\167\063\011\155\166\217\200\264\033\210\142\217\365\207\307\234"
	"\104\177\137\051\151\117\076\366\072\353\372\151\254\322\203\271"
	"\205\124\277\361\302\233\363\176\144\055\366\056\112\351\233\360"
	"\065\230\144\112\121\117\204\106\032\236\236\276\373\021\012\011"
	"\345\267\076\122\270\272\253\027\345\317\050\120\257\034\105\216"
	"\036\165\002\225\041\125\272\317\235\351\122\236\344\325\265\210"
	"\325\132\050\114\164\163\032\014\045\042\134\116\206\272\342\141"
	"\303\057\343\203\316\257\165\037\027\233\114\226\354\142\005\173"
	"\347\100\146\141\170\330\216\104\126\344\072\172\003\064\253\204"
	"\210\327\011\155\070\046\172\275\005\126\140\312\333\220\347\262"
	"\070\313\262\076\274\220\314\301\337\233\102\355\315\254\210\053"
	"\203\250\210\134\105\350\317\236\104\044\331\063\132\310\154\001"
	"\336\113\245\350\247\031\023\043\265\221\030\116\360\217\245\203"
	"\200\006\367\175\104\313\234\230\166\325\331\140\045\153\326\120"
	"\242\265\153\074\122\241\154\245\247\242\242\214\300\240\210\307"
	"\036\267\200\147\215\257\320\213\357\343\313\177\227\125\035\276"
	"\317\002\311\244\147\176\367\070\022\075\254\171\267\204\245\004"
	"\242\134\270\157\200\222\111\226\373\167\245\247\111\061\150\175"
	"\007\175\367\261\104\006\224\325\060\343\365\266\155\376\106\365"
	"\074\132\021\234\001\017\006\050\113\370\030\261\150\214\205\026"
	"\330\060\014\132\263\334\225\134\255\147\353\016\276\027\031\204"
	"\364\011\061\136\044\034\166\200\200\266\223\324\113\172\230\051"
	"\326\327\137\031\137\137\240\057\001\224\346\021\361\332\334\244"
	"\307\360\365\313\254\014\055\135\126\155\221\374\203\104\110\250"
	"\256\062\120\327\233\312\145\312\243\254\303\005\100\303\304\072"
	"\364\041\124\266\077\001\140\116\167\011\270\170\332\003\175\361"
	"\030\266\262\151\202\341\257\224\322\256\173\062\213\007\063\032"
	"\307\302\054\242\310\316\325\161\210\354\341\245\117\105\153\070"
	"\041\306\131\017\352\124\016\374\302\222\113\232\367\364\165\122"
	"\031\164\204\116\123\107\130\041\176\245\052\256\300\307\121\240"
	"\332\252\060\067\227\171\005\047\162\002\156\252\156\340\174\343"
	"\203\302\302\101\057\047\055\121\043\057\324\247\124\367\257\041"
	"\266\073\271\033\071\302\340\244\167\076\125\354\043\335\235\313"
	"\047\262\221\346\324\277\240\013\240\075\222\165\157\333\015\033"
	"\326\370\263\013\326\225\275\317\315\131\175\157\372\003\036\111"
	"\333\376\210\363\247\144\015\017\030\063\367\231\160\267\071\314"
	"\023\103\130\177\117\275\114\312\074\376\256\142\000\360\211\357"
	"\052\017\333\204\330\016\354\055\126\060\344\306\006\367\234\332"
	"\323\160\030\117\277\171\357\334\334\223\002\141\277\266\240\026"
	"\224\057\044\225\051\260\152\224\324\353\231\055\373\354\242\124"
	"\051\065\164\245\105\310\031\023\043\332\020\334\372\237\016\245"
	"\367\266\065\135\355\256\064\053\213\154\240\064\301\160\262\175"
	"\363\325\241\337\027\331\143\103\216\345\257\335\267\044\200\063"
	"\344\314\102\275\257\010\004\170\006\272\112\151\015\203\262\116"
	"\242\111\123\150\155\256\306\134\037\245\316\336\002\015\156\322"
	"\304\305\060\203\215\312\326\154\202\171\144\357\160\172\210\261"
	"\255\073\332\363\340\062\044\204\342\340\262\051\032\170\337\300"
	"\043\025\357\216\157\012\170\204\265\013\252\063\210\133\274\140"
	"\301\266\333\250\046\315\030\020\247\344\017\070\006\343\275\316"
	"\103\046\140\105\004\157\021\143\240\045\354\025\023\215\015\375"
	"\177\024\252\202\171\162\324\117\014\142\340\151\153\337\030\076"
	"\122\055\334\050\246\042\070\245\024\174\302\062\272\272\327\345"
	"\071\324\363\055\234\172\156\140\142\262\012\012\131\144\304\232"
	"\032\135\060\354\221\335\126\267\142\160\035\261\136\203\274\270"
	"\202\251\171\237\050\034\315\074\056\365\241\354\130\257\105\006"
	"\006\053\004\337\142\274\374\103\324\164\022\076\170\034\237\000"
	"\273\144\053\062\256\104\226\226\227\007\243\166\243\262\243\367"
	"\320\112\026\215\017\364\221\006\000\032\107\361\301\202\106\041"
	"\352\077\132\254\154\326\261\347\026\034\237\265\306\073\300\243"
	"\132\204\006\132\140\215\344\142\060\061\172\262\054\172\030\365"
	"\371\132\363\207\377\247\365\264\227\323\334\060\207\070\341\010"
	"\015\365\332\322\274\020\036\033\076\323\065\000\133\177\275\156"
	"\214\313\070\021\010\070\177\134\147\346\031\232\344\240\233\177"
	"\044\101\302\226\255\243\305\267\216\332\237\046\012\174\375\075"
	"\324\274\255\141\357\045\265\042\343\236\134\375\004\234\213\223"
	"\337\004\206\247\300\160\040\224\252\060\325\166\034\162\306\125"
	"\241\106\103\021\166\344\347\361\377\005\152\123\306\172\066\123"
	"\251\002\315\036\340\004\326\314\101\014\165\275\306\205\304\166"
	"\275\271\077\172\317\145\070\314\026\363\253\277\073\064\372\154"
	"\116\125\346\120\304\336\275\125\222\217\306\070\127\040\340\032"
	"\247\333\302\131\025\326\323\137\210\344\161\044\325\116\074\102"
	"\273\170\032\265\205\150\034\244\135\015\061\331\166\055\036\301"
	"\150\131\007\271\106\266\056\377\326\136\143\111\167\127\142\017"
	"\047\200\133\304\225\203\350\324\152\017\320\220\044\145\312\230"
	"\264\264\174\357\306\330\017\025\323\162\314\174\350\302\273\217"
	"\165\012\261\333\035\217\240\110\014\012\105\171\161\225\273\012"
	"\321\145\247\065\154\352\270\256\276\214\067\304\126\010\141\054"
	"\071\372\235\000\250\317\111\175\064\071\243\163\365\261\201\003"
	"\263\261\160\231\074\041\364\021\312\301\264\227\257\153\263\314"
	"\304\367\072\015\141\046\300\132\127\337\033\330\140\030\015\021"
	"\323\250\230\375\203\372\300\165\055\360\041\150\126\064\010\005"
	"\145\170\155\065\211\131\122\355\170\373\306\007\035\051\303\016"
	"\227\167\201\136\046\170\030\053\250\104\026\342\147\254\266\306"
	"\256\073\267\244\243\047\234\343\113\001\372\343\124\207\005\273"
	"\177\057\232\064\114\277\122\322\223\142\337\214\120\067\162\304"
	"\321\230\214\140\120\261\173\117\301\310\330\144\307\012\273\227"
	"\362\371\177\052\017\256\016\113\232\126\126\360\055\117\336\360"
	"\060\015\155\116\150\053\174\147\012\151\046\272\346\347\256\260"
	"\032\010\140\065\206\307\370\320\234\132\222\056\363\361\044\236"
	"\130\056\157\023\076\030\165\227\160\103\216\022\223\242\144\057"
	"\377\172\125\123\154\270\304\330\243\345\223\000\014\212\154\121"
	"\103\340\250\374\133\201\372\276\365\204\103\027\273\007\372\325"
	"\277\040\065\336\006\347\016\360\321\027\215\177\074\356\217\042"
	"\143\254\340\050\021\271\011\142\342\274\210\115\266\350\367\363"
	"\154\045\160\007\155\072\260\034\353\244\130\175\060\156\070\043"
	"\066\140\323\071\026\272\040\331\154\174\301\167\004\273\015\343"
	"\057\324\105\174\062\335\046\263\134\302\126\023\333\107\271\314"
	"\350\271\051\274\344\024\115\171\031\207\013\266\302\025\244\166"
	"\366\063\137\103\012\220\062\001\037\057\246\221\223\210\126\136"
	"\014\336\111\353\316\114\034\013\375\271\113\066\362\213\354\167"
	"\152\000\065\241\345\263\101\056\103\244\024\350\337\031\370\117"
	"\045\016\232\367\150\157\325\300\277\126\367\136\302\174\051\060"
	"\373\124\003\201\062\055\211\320\332\042\265\016\223\211\363\306"
	"\167\312\262\236\342\221\120\104\101\240\227\264\312\104\102\163"
	"\363\051\363\211\236\240\051\264\227\132\340\313\070\267\123\312"
	"\220\232\304\357\126\357\137\165\066\042\344\065\216\333\251\211"
	"\104\143\025\267\364\332\301\364\253\017\317\370\043\304\263\311"
	"\121\215\265\313\123\201\270\265\121\176\237\266\030\200\072\272"
	"\353\153\303\166\122\137\013\370\214\143\174\176\360\351\130\071"
	"\032\201\170\212\353\307\355\243\307\317\043\366\164\241\146\125"
	"\240\123\003\067\067\142\155\037\116\023\320\024\033\301\045\357"
	"\171\073\254\313\270\173\367\371\006\036\102\262\350\156\014\252"
	"\202\111\200\151\077\362\270\343\240\153\265\005\272\132\310\327"
	"\150\175\213\061\331\320\254\372\070\064\015\343\131\242\221\241"
	"\111\177\342\271\311\242\117\206\251\240\023\173\275\255\002\204"
	"\002\055\255\204\045\377\116\144\241\264\204\064\326\151\175\055"
	"\323\146\224\100\256\365\311\005\356\040\151\150\065\367\116\351"
	"\233\035\202\110\154\227\367\207\076\007\140\337\234\115\007\265"
	"\320\231\011\054\111\206\132\215\050\146\246\367\171\157\262\173"
	"\002\220\137\173\217\174\203\271\147\141\352\013\273\130\141\334"
	"\133\273\043\263\206\040\352\310\245\246\362\313\066\142\262\223"
	"\176\107\253\200\222\116\175\271\257\220\174\017\310\130\013\262"
	"\126\345\164\254\234\301\125\165\225\112\314\031\261\245\343\357"
	"\261\257\367\244\172\207\067\172\076\045\236\142\326\077\103\106"
	"\112\007\115\100\063\031\220\355\366\310\201\075\322\360\112\163"
	"\350\230\115\123\340\031\340\246\324\233\326\153\376\136\122\152"
	"\105\211\152\311\076\255\320\253\227\320\131\241\104\370\040\044"
	"\053\271\063\151\273\334\161\206\111\023\127\220\037\370\002\125"
	"\027\032\310\071\217\146\323\035\361\150\133\075\227\030\344\232"
	"\071\162\124\272\326\045\054\347\204\167\226\301\071\264\361\017"
	"\027\346\073\030\000\263\250\211\041\100\232\164\041\376\026\233"
	"\317\022\063\370\261\370\165\135\214\200\005\003\055\035\217\164"
	"\220\322\254\337\231\337\130\160\255\200\166\343\312\060\027\143"
	"\225\361\036\200\323\373\172\070\344\277\376\171\262\026\172\345"
	"\254\230\050\365\033\263\164\267\005\240\223\165\304\177\153\271"
	"\123\126\163\004\037\134\051\115\303\201\254\003\271\170\262\156"
	"\113\023\106\025\175\356\045\162\017\155\073\032\164\142\231\327"
	"\160\062\050\126\132\277\252\364\065\366\256\322\323\170\223\271"
	"\362\266\332\131\052\273\342\266\125\201\212\037\117\004\112\274"
	"\176\300\213\134\062\316\251\016\253\354\075\225\061\253\264\162"
	"\107\065\254\271\332\375\357\251\212\256\211\055\305\102\325\074"
	"\035\321\260\006\002\134\367\101\120\277\312\313\120\357\301\377"
	"\147\036\133\013\313\166\134\361\113\211\201\126\241\252\056\350"
	"\245\364\062\061\272\121\041\264\056\231\332\102\214\001\127\302"
	"\230\157\000\167\342\367\324\205\023\110\017\213\267\206\135\176"
	"\116\263\371\047\255\211\001\015\366\233\313\324\104\212\371\305"
	"\013\277\052\035\110\375\224\122\242\005\314\102\356\243\352\334"
	"\017\065\017\235\334\033\045\364\167\041\263\041\075\362\052\243"
	"\364\073\027\327\034\314\134\211\277\004\116\235\377\034\221\134"
	"\037\246\055\026\362\375\235\235\257\035\107\064\266\123\367\121"
	"\234\231\215\374\077\175\063\133\231\034\241\334\302\367\302\101"
	"\374\210\126\054\011\301\006\122\122\014\121\040\210\374\225\305"
	"\064\036\313\302\036\062\176\356\242\074\143\303\016\120\112\100"
	"\173\270\136\363\174"
#define      tst1_z	22
#define      tst1	((&data[3863]))
	"\144\050\266\311\030\223\353\202\140\243\120\252\171\064\374\060"
	"\201\250\075\032\235\056\334\037\302\222\131"
#define      opts_z	1
#define      opts	((&data[3890]))
	"\232"
#define      tst2_z	19
#define      tst2	((&data[3891]))
	"\227\206\101\271\327\052\002\015\113\153\230\306\073\332\333\016"
	"\377\130\240\063\200\127\113"/* End of data[] */;
#define      hide_z	4096
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask  = (unsigned long)&chkenv;
	mask ^= (unsigned long)getpid() * ~mask;
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
#	define PTRACE_ATTACH	PT_ATTACH
#endif
void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PTRACE_ATTACH, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];

	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	ret = chkenv(argc);
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
	varg[j++] = argv[0];		/* My own name at execution */
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
