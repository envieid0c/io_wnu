#if 0
	shc Version 3.9.3a1, Generic Shell Script Compiler
	GNU GPL Version 3 Fedor Mankov <envieidoc@gmail.com>

	./shc -v -r -f io_wnu_uninstall.sh 
#endif

static  char data [] = 
#define      msg2_z	19
#define      msg2	((&data[1]))
	"\230\320\316\355\351\123\117\155\210\250\021\172\317\145\275\036"
	"\044\157\322\045\101\011\172\330"
#define      pswd_z	256
#define      pswd	((&data[61]))
	"\267\324\346\061\205\004\112\021\242\240\120\274\322\332\115\005"
	"\212\370\322\060\245\267\034\215\346\223\217\117\301\047\317\152"
	"\060\355\335\076\264\221\005\116\352\242\254\257\222\133\141\206"
	"\121\134\375\241\231\145\374\377\314\155\353\306\042\127\123\344"
	"\040\137\214\112\067\045\344\372\045\350\013\375\161\064\053\232"
	"\321\023\341\146\337\274\055\204\070\020\103\123\125\006\050\353"
	"\327\157\352\013\316\011\346\032\201\242\242\072\263\146\215\200"
	"\014\004\340\244\132\362\174\161\101\276\272\314\304\174\006\263"
	"\332\301\330\333\153\107\004\263\237\376\030\224\201\241\345\112"
	"\343\331\344\367\346\027\125\364\222\364\360\145\052\052\343\222"
	"\271\046\227\014\163\110\004\153\030\263\352\314\373\366\133\241"
	"\147\045\146\062\033\350\177\017\232\017\231\253\046\201\311\063"
	"\310\173\127\065\074\212\252\244\326\245\064\035\216\216\135\257"
	"\112\114\042\354\045\270\263\312\311\150\132\112\121\277\343\230"
	"\161\301\033\035\152\126\030\212\102\271\257\335\243\164\001\341"
	"\345\103\030\116\036\365\355\174\340\340\274\112\015\363\141\170"
	"\144\023\323\316\252\316\116\104\050\350\001\167\032\043\266\236"
	"\020\141\071\344\065\106\212\216\004\254\034\061\200\336\111\131"
	"\230\162\176\017\360\104\216\303\173\154\342\245\247\366\301\207"
	"\112\220\220\144\317\012\376\310\256\260\132\246\277\222"
#define      lsto_z	1
#define      lsto	((&data[342]))
	"\331"
#define      chk1_z	22
#define      chk1	((&data[343]))
	"\262\235\054\277\243\373\253\042\364\257\162\244\226\317\216\375"
	"\037\113\120\062\004\155\145\211\157"
#define      tst2_z	19
#define      tst2	((&data[368]))
	"\306\366\372\167\225\262\365\255\046\100\201\353\277\036\035\336"
	"\370\250\120\055\140"
#define      text_z	1100
#define      text	((&data[644]))
	"\031\040\005\026\016\334\224\016\242\110\275\265\312\302\314\012"
	"\157\327\377\061\130\346\253\243\362\044\063\121\044\227\267\355"
	"\024\322\013\126\003\231\023\266\360\232\105\333\142\167\126\026"
	"\010\163\211\020\175\230\317\147\005\244\124\146\255\002\372\217"
	"\167\221\074\006\221\360\174\126\322\171\341\130\111\256\175\361"
	"\101\264\025\230\021\233\175\131\003\116\361\173\354\034\104\162"
	"\253\335\356\145\350\354\100\322\344\154\310\201\201\150\240\130"
	"\233\347\132\003\162\105\016\356\274\313\337\273\146\251\327\362"
	"\117\330\221\060\244\022\250\370\051\177\311\037\052\312\064\067"
	"\026\164\327\161\345\361\306\057\341\333\132\351\204\325\373\170"
	"\231\251\227\335\014\125\144\024\313\105\160\051\120\123\113\264"
	"\223\250\102\127\344\116\010\160\371\215\040\347\077\247\210\223"
	"\301\207\063\021\353\054\010\124\357\240\041\322\122\041\136\360"
	"\103\235\040\125\005\157\345\224\172\117\305\254\175\375\064\020"
	"\371\076\022\217\064\114\076\053\065\024\373\133\140\064\363\066"
	"\353\067\173\174\004\157\260\363\154\047\211\014\017\213\220\060"
	"\112\242\046\234\236\052\000\242\001\067\036\253\104\033\065\312"
	"\070\337\271\344\265\375\112\354\335\141\066\122\112\007\362\125"
	"\247\312\143\373\133\332\047\345\155\305\353\326\055\016\000\145"
	"\226\041\156\222\217\041\322\366\344\204\062\144\127\351\277\222"
	"\302\250\057\256\223\340\365\141\160\160\050\113\303\167\013\342"
	"\166\224\210\107\163\206\005\200\034\332\337\020\153\034\143\125"
	"\124\211\311\050\074\073\015\070\061\360\023\252\125\316\025\142"
	"\016\154\324\143\345\065\130\072\350\067\135\045\075\315\201\265"
	"\036\234\035\274\003\336\272\147\252\037\143\115\162\312\071\316"
	"\223\247\362\174\063\173\346\114\236\220\237\104\333\212\222\230"
	"\233\214\211\051\062\360\044\172\107\026\212\033\072\063\343\104"
	"\275\173\170\354\107\143\355\204\004\045\115\205\373\171\130\247"
	"\001\021\047\330\140\173\237\004\046\017\125\030\355\223\371\356"
	"\017\062\372\007\016\203\116\337\121\275\004\226\071\241\144\371"
	"\102\372\165\160\133\330\032\253\110\041\312\254\105\353\323\015"
	"\252\006\213\020\235\365\132\206\370\131\326\267\346\246\300\146"
	"\312\114\315\126\304\235\160\112\072\010\250\302\117\121\005\351"
	"\312\310\163\301\367\113\270\356\216\261\203\220\320\367\070\253"
	"\231\330\154\065\336\313\126\211\365\065\103\056\341\363\351\136"
	"\250\305\130\343\277\062\121\205\225\266\334\041\034\151\362\071"
	"\301\135\272\024\314\016\227\012\365\032\237\002\136\021\042\066"
	"\136\054\162\015\310\246\154\017\305\115\323\062\260\147\377\270"
	"\231\045\125\312\330\154\316\173\017\307\135\000\234\324\210\010"
	"\201\206\033\376\071\030\155\061\324\222\227\153\206\267\030\241"
	"\267\335\314\371\340\230\374\033\063\073\247\207\210\131\174\002"
	"\264\227\314\046\025\115\321\263\002\324\143\121\171\250\102\200"
	"\003\237\347\262\225\240\266\206\100\213\171\104\361\362\134\222"
	"\250\117\244\236\205\210\372\204\173\066\253\321\076\056\120\242"
	"\201\050\135\324\270\336\215\243\254\355\235\024\027\124\271\274"
	"\171\104\325\304\023\103\265\162\254\351\204\051\355\121\257\344"
	"\230\323\006\347\276\141\355\165\335\353\103\305\221\223\263\377"
	"\077\016\140\356\372\373\236\213\101\145\027\207\320\043\322\037"
	"\360\131\115\015\227\064\133\370\345\322\025\025\073\317\212\132"
	"\066\272\346\017\170\303\067\216\007\237\020\121\122\116\167\076"
	"\030\117\114\042\175\053\001\105\134\111\076\047\000\304\365\257"
	"\213\226\142\270\116\351\207\174\202\044\243\127\363\135\013\376"
	"\264\144\220\032\262\036\344\040\173\042\261\156\312\211\073\251"
	"\063\041\050\215\242\073\364\360\140\314\011\062\152\214\352\336"
	"\343\360\277\041\004\064\261\223\231\062\221\312\151\124\055\072"
	"\172\065\142\060\255\015\346\114\015\262\366\064\006\333\347\002"
	"\220\066\367\162\163\133\172\356\067\217\200\362\361\222\066\315"
	"\125\125\172\320\276\042\255\043\376\261\342\234\014\130\115\353"
	"\021\343\077\336\025\023\265\310\204\221\310\300\325\054\226\234"
	"\377\234\007\200\060\064\300\230\054\076\015\321\113\130\027\304"
	"\026\062\245\070\300\025\014\112\143\073\302\173\310\101\311\001"
	"\036\230\153\173\261\240\270\351\024\010\025\147\107\273\151\037"
	"\213\076\232\226\135\140\256\272\062\156\311\305\204\030\370\145"
	"\100\045\071\043\001\332\220\173\121\335\234\354\070\207\023\154"
	"\004\311\176\247\311\264\221\220\253\324\166\140\337\347\366\077"
	"\363\172\042\300\157\100\144\357\264\125\227\346\321\154\250\352"
	"\074\370\156\253\235\315\357\164\025\320\116\165\124\264\353\305"
	"\155\132\314\247\116\124\363\323\045\036\210\162\234\173\144\150"
	"\361\162\042\257\204\146\277\210\040\133\176\130\111\250\173\214"
	"\045\361\306\075\104\131\010\207\307\312\075\111\335\006\366\355"
	"\174\321\274\014\201\235\227\130\213\302\377\135\336\055\314\330"
	"\050\076\272\312\125\130\306\010\242\303\334\071\125\151\303\103"
	"\170\141\205\313\004\262\062\072\073\064\072\044\376\100\041\117"
	"\353\273\252\106\317\152\354\211\310\142\023\264\252\033\116\041"
	"\101\174\016\145\040\206\266\360\346\346\301\267\004\161\104\206"
	"\246\215\306\300\372\244\037\211\312\212\301\363\023\112\170\367"
	"\363\003\133\105\076\300\030\050\245\170\000\166\241\177\140\373"
	"\105\120\365\167\144\356\130\137\035\053\062\323\121\172\245\003"
	"\067\253\271\343\072\366\231\034\042\355\007\062\304\132\044\006"
	"\003\200\306\335\055\357\064\153\352\115\066\377\101\253\070\316"
	"\324\353\224\110\030\173\243\307\321\274\023\307\200\067\253\067"
	"\247\165\107\157\076\263\277\150\126\036\275\271\270\114\126\314"
	"\376\200\206\313\030\143\055\201\015\361\272\103\011\363\123\361"
	"\162\272\166\164\066\125\117\206\001\253\072\114\332\055\263\120"
	"\375\346\167\020\363\122\200\152\330\346\106\222\356\103\153\155"
	"\200\023\352\041\141\356\053\345\131\202\240\253\327\060\152\375"
	"\077\122\356\240\330\146\332\110\262\102\323\256\161\130\376\305"
	"\016\330\305\371\265\055\373\223\353\255\272\075\144\046\152\060"
	"\047\224\223\002\000\130\042\370\211\267\116\070\006\264\174\376"
	"\161\102\230\231\201\323\142\170\374\371\245\246\011\027\310\106"
	"\073\327\237\367\126\335\104\345\264\134\274\222\246\014\135\037"
	"\151\173\277\230\003\332\372\011\315\052\203\142\225\210\072\310"
	"\052\240\024\152\302\017\365\153\371\357\166\355\354\147\154\030"
	"\044\151\236\035\270\334\253\077\034\237\162\317\163\250\033\275"
	"\302\371\031\040\374\376\170\163\263\265\074\137\132\232\037\031"
	"\053\065\143\362\321\230\301\266\130\102\061\334\215\263\332\126"
	"\110\047\070\231\164\240\163\257\240\162\060\156\067\026\271\312"
	"\054\004\130\311\271\364\315\134\156\171\020\263\174\221\250\164"
	"\226\272\121\350\327\007\212\331\332\354\023\141\275\140\257\242"
	"\002\105\002\054\145\375\056\321\100\170\067\371\256\301\167\343"
	"\364\124\231"
#define      chk2_z	19
#define      chk2	((&data[1992]))
	"\111\372\133\114\244\005\052\367\326\033\325\176\030\234\152\276"
	"\363\063\051\112\206\056\006"
#define      tst1_z	22
#define      tst1	((&data[2019]))
	"\370\341\177\120\317\254\205\042\202\257\106\130\226\266\217\052"
	"\010\056\335\055\326\146\163\315\121\000\143"
#define      rlax_z	1
#define      rlax	((&data[2042]))
	"\122"
#define      msg1_z	65
#define      msg1	((&data[2046]))
	"\332\117\176\340\253\237\101\003\256\204\151\062\350\265\376\062"
	"\032\217\321\004\221\360\246\376\003\065\235\115\211\005\333\037"
	"\003\232\115\165\204\303\301\114\067\370\356\304\142\230\304\014"
	"\260\365\060\143\010\031\224\327\244\151\151\160\320\254\317\255"
	"\240\341\204\033\010\121\303\232\313\303\165\313\120\001\122\117"
	"\111\135\312"
#define      shll_z	10
#define      shll	((&data[2128]))
	"\342\357\245\343\247\041\006\010\142\130\361\025\177"
#define      date_z	1
#define      date	((&data[2139]))
	"\356"
#define      inlo_z	3
#define      inlo	((&data[2140]))
	"\274\052\342"
#define      xecc_z	15
#define      xecc	((&data[2146]))
	"\147\271\357\051\173\076\101\257\106\344\067\135\246\265\104\201"
	"\370\043"
#define      opts_z	1
#define      opts	((&data[2161]))
	"\206"/* End of data[] */;
#define      hide_z	4096
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask  = (unsigned long)&chkenv;
	mask ^= (unsigned long)getpid() * ~mask;
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
#	define PTRACE_ATTACH	PT_ATTACH
#endif
void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PTRACE_ATTACH, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = getenv("_");
	if (me == NULL) { me = argv[0]; }

	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	ret = chkenv(argc);
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
