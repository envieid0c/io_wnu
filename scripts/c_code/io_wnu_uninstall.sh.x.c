#if 0
	shc Version 3.9.3a3, Generic Shell Script Compiler
	GNU GPL Version 3 Fedor Mankov <envieidoc@gmail.com>

	./shc -v -r -f io_wnu_uninstall.sh 
#endif

static  char data [] = 
#define      text_z	1100
#define      text	((&data[166]))
	"\310\366\335\054\206\374\212\161\373\341\153\210\004\351\260\141"
	"\240\244\334\075\073\312\135\033\137\277\054\210\167\331\005\246"
	"\362\224\001\377\170\031\107\323\173\322\072\165\372\356\334\002"
	"\202\075\156\137\176\015\364\116\053\107\371\276\112\003\366\167"
	"\112\371\133\062\364\344\343\260\265\014\276\376\344\331\147\301"
	"\307\370\202\232\205\133\245\227\217\057\144\252\327\121\364\151"
	"\003\176\355\142\251\106\246\023\171\334\001\273\356\072\220\127"
	"\154\032\257\317\025\034\217\315\202\076\220\310\262\112\136\345"
	"\112\143\352\071\263\341\052\113\017\167\346\336\014\175\245\143"
	"\350\142\370\252\054\027\015\157\043\175\155\351\042\074\311\210"
	"\115\162\027\120\054\017\232\305\234\026\303\154\201\251\256\146"
	"\376\113\157\351\053\356\331\253\030\343\113\255\114\204\164\102"
	"\047\125\051\276\226\357\314\272\274\007\067\310\122\002\040\320"
	"\335\316\102\107\301\372\106\322\240\221\064\175\144\121\275\241"
	"\337\325\250\126\026\073\272\104\143\217\350\021\241\223\065\042"
	"\363\045\056\064\175\147\225\043\275\353\136\257\171\366\104\376"
	"\231\104\061\302\121\237\332\210\237\211\373\374\077\377\372\064"
	"\006\163\042\311\076\112\154\321\214\317\131\010\172\134\111\376"
	"\012\303\240\070\342\107\251\204\162\352\162\317\103\135\315\377"
	"\256\312\230\222\246\203\253\002\163\256\055\357\006\322\324\321"
	"\330\362\053\243\221\031\111\343\130\300\243\317\374\307\065\245"
	"\023\222\041\046\222\020\366\121\035\113\242\200\032\227\201\313"
	"\113\257\150\213\016\270\002\311\200\045\247\014\344\205\111\060"
	"\004\360\056\017\332\045\023\131\357\343\236\247\371\147\033\140"
	"\171\047\011\225\033\206\171\023\024\160\345\361\143\033\306\135"
	"\021\037\025\273\347\045\014\051\263\357\260\125\374\361\151\315"
	"\141\245\114\257\267\103\006\062\262\203\360\137\242\056\241\236"
	"\216\332\011\367\173\163\365\205\114\362\124\007\017\353\060\275"
	"\110\230\330\364\362\322\051\176\115\223\303\250\111\224\340\052"
	"\311\232\310\023\357\057\074\241\041\227\252\144\307\001\133\325"
	"\203\164\157\247\356\071\163\042\323\337\167\240\004\053\025\165"
	"\040\154\221\114\232\247\252\131\273\344\226\015\006\160\110\031"
	"\002\216\135\175\340\061\202\155\107\246\316\034\200\254\117\017"
	"\353\103\106\167\024\033\244\274\116\071\150\110\000\115\046\315"
	"\326\043\226\251\007\016\227\077\276\022\041\000\276\040\070\140"
	"\254\276\265\203\213\212\266\376\307\006\320\007\365\045\274\025"
	"\357\037\044\172\250\261\346\114\057\371\102\025\276\117\075\002"
	"\006\270\261\342\277\077\113\170\255\112\165\157\155\072\225\335"
	"\200\043\054\346\017\371\237\246\125\204\067\031\327\015\061\203"
	"\326\273\167\007\332\330\171\147\005\107\005\276\002\341\315\216"
	"\155\101\050\257\372\126\304\071\070\312\157\370\263\306\026\123"
	"\011\246\371\104\015\073\123\355\040\316\250\166\104\215\027\245"
	"\230\171\065\262\005\111\263\113\033\146\045\125\323\313\310\324"
	"\221\205\141\174\146\260\147\231\274\052\126\255\224\070\234\101"
	"\143\147\050\176\161\145\076\163\226\076\375\066\050\075\145\111"
	"\055\344\114\122\104\223\226\332\173\275\272\072\371\123\036\210"
	"\350\154\376\273\155\324\276\215\041\376\237\043\332\313\252\044"
	"\165\333\130\166\336\032\214\266\223\116\027\300\002\136\324\234"
	"\320\324\363\251\007\215\245\204\140\270\263\340\363\257\111\327"
	"\023\105\171\256\173\123\163\027\042\101\024\026\373\372\301\052"
	"\175\272\000\366\022\010\135\173\212\100\071\200\334\003\021\213"
	"\064\375\167\362\254\172\342\012\273\016\132\301\246\172\310\047"
	"\207\160\116\010\131\274\355\100\030\334\050\370\131\052\135\114"
	"\105\124\365\301\216\354\147\114\251\243\373\053\140\350\353\215"
	"\320\165\010\141\016\254\215\132\056\267\034\204\055\100\222\045"
	"\105\224\373\017\063\336\373\151\204\035\251\121\027\036\105\314"
	"\044\206\226\363\252\363\064\143\266\152\246\350\066\031\346\152"
	"\101\111\274\033\041\052\246\152\050\034\150\262\024\010\277\167"
	"\254\147\324\043\003\063\355\326\120\322\231\225\073\345\004\201"
	"\166\275\350\261\155\325\114\155\304\220\344\035\304\247\337\071"
	"\251\121\043\057\110\102\106\223\220\033\042\174\257\304\072\151"
	"\154\230\243\266\146\175\202\336\343\235\250\012\171\324\072\310"
	"\065\217\171\264\070\211\316\301\146\170\302\252\210\154\031\145"
	"\112\346\272\214\351\102\266\247\123\141\340\351\357\201\320\030"
	"\357\323\327\234\026\003\246\007\104\127\244\011\223\366\210\075"
	"\307\122\077\046\234\310\051\071\205\106\241\032\336\071\177\220"
	"\206\321\125\157\010\320\040\352\336\175\317\111\130\144\245\317"
	"\257\265\075\107\121\027\363\233\216\216\236\263\034\334\164\301"
	"\304\072\331\155\247\063\244\320\137\301\067\252\323\004\233\127"
	"\202\114\362\202\204\054\160\127\307\212\231\241\074\174\312\261"
	"\113\220\115\013\065\031\314\025\302\232\253\104\112\146\235\263"
	"\240\046\247\010\324\265\153\256\175\316\032\243\273\264\176\007"
	"\226\340\266\263\356\213\070\103\165\022\326\277\344\037\013\005"
	"\131\250\022\137\347\102\130\246\027\271\206\111\136\004\244\147"
	"\072\252\344\147\307\067\177\126\327\122\012\352\224\145\024\271"
	"\266\164\226\031\071\110\041\260\067\011\367\374\065\005\174\132"
	"\271\363\344\142\034\321\102\234\210\214\213\137\337\067\145\150"
	"\144\331\331\204\340\104\276\302\252\150\261\220\002\034\343\362"
	"\354\046\234\252\016\212\042\011\147\116\124\360\364\341\067\144"
	"\236\260\233\222\176\275\231\176\056\313\206\235\100\132\043\014"
	"\226\253\314\144\242\356\313\003\304\336\256\023\215\124\314\366"
	"\012\343\116\022\315\357\267\361\327\255\114\004\351\050\350\227"
	"\025\310\037\346\206\213\015\367\043\230\176\006\004\305\067\141"
	"\327\302\154\126\354\237\264\324\352\100\361\210\241\017\305\012"
	"\062\271\254\163\134\327\025\151\375\125\230\171\011\157\174\022"
	"\021\035\046\334\270\112\262\251\213\055\070\204\030\321\151\077"
	"\026\332\203\313\076\137\374\103\156\210\030\057\033\273\204\164"
	"\110\167\246\340\141\017\325\033\355\177\342\221\330\154\225\250"
	"\304"
#define      xecc_z	15
#define      xecc	((&data[1411]))
	"\222\372\215\254\171\135\223\124\274\004\011\136\344\243\271\233"
	"\027"
#define      tst2_z	19
#define      tst2	((&data[1430]))
	"\344\117\270\256\316\050\351\242\205\075\027\051\260\263\001\171"
	"\223\261\043\111\240\122\173\370"
#define      lsto_z	1
#define      lsto	((&data[1450]))
	"\031"
#define      tst1_z	22
#define      tst1	((&data[1456]))
	"\152\075\240\224\245\152\211\251\347\334\130\127\074\145\137\253"
	"\227\205\346\140\212\031\132\306\071\042\217"
#define      chk1_z	22
#define      chk1	((&data[1478]))
	"\252\365\011\252\145\247\125\020\043\333\000\372\216\311\347\071"
	"\262\303\330\215\124\000\117\015\215"
#define      inlo_z	3
#define      inlo	((&data[1503]))
	"\004\017\054"
#define      msg2_z	19
#define      msg2	((&data[1507]))
	"\204\313\220\314\312\264\037\261\227\171\065\012\340\373\072\174"
	"\236\052\215\044\304\201"
#define      chk2_z	19
#define      chk2	((&data[1530]))
	"\140\135\224\044\107\021\033\127\211\130\354\214\266\013\164\052"
	"\372\035\222\155\114"
#define      pswd_z	256
#define      pswd	((&data[1607]))
	"\320\106\135\037\012\015\353\240\235\041\272\220\376\341\255\322"
	"\035\051\364\311\365\040\222\344\126\020\015\373\100\150\076\267"
	"\001\034\225\240\250\354\331\162\246\122\045\335\314\047\374\052"
	"\002\265\043\257\106\377\030\141\131\162\015\351\227\174\046\332"
	"\146\212\341\126\275\237\012\205\015\165\313\200\345\104\375\117"
	"\272\110\021\267\246\256\175\310\040\004\241\157\137\325\201\332"
	"\262\154\221\326\161\274\373\312\100\065\040\327\234\200\221\310"
	"\266\061\265\376\117\047\246\036\052\205\145\150\246\174\235\361"
	"\270\111\263\166\103\034\261\213\142\242\375\266\166\044\240\362"
	"\370\334\043\031\204\266\264\117\101\276\136\126\150\213\220\261"
	"\003\161\361\142\104\006\333\147\065\141\213\230\157\156\101\111"
	"\064\276\373\316\023\347\117\227\034\135\061\337\067\071\317\205"
	"\103\370\010\034\172\303\271\231\277\350\001\274\144\205\133\041"
	"\060\035\251\332\077\040\214\366\353\101\111\374\133\304\000\044"
	"\371\105\170\270\027\205\345\367\013\046\107\107\212\274\243\125"
	"\171\234\177\320\122\072\373\230\166\303\216\115\171\363\126\161"
	"\022\306\254\274\063\364\333\357\134\376\056\321\123\157\247\204"
	"\263\066\102\140\152\304\331\315\311\275\151\062\064\377\205\047"
	"\350\047\146\231\175\300\300\037\230\351\227\017\157\015\214\244"
	"\334\266\064\377\363\251\124\336\254\037\156\352\372\223\076\142"
#define      date_z	1
#define      date	((&data[1869]))
	"\017"
#define      opts_z	1
#define      opts	((&data[1870]))
	"\230"
#define      msg1_z	62
#define      msg1	((&data[1878]))
	"\315\134\176\306\043\314\141\254\167\265\075\312\221\332\256\072"
	"\053\260\170\316\205\062\170\106\234\317\005\172\060\016\321\346"
	"\163\261\226\315\371\200\273\102\054\235\036\336\257\113\112\240"
	"\312\362\267\334\317\137\121\261\306\133\052\130\054\060\244\342"
	"\352\344\135\320\366\163\014\306\271\321\326\255\222\207"
#define      shll_z	10
#define      shll	((&data[1951]))
	"\305\052\210\356\064\312\170\131\310\102\352\100\073"
#define      rlax_z	1
#define      rlax	((&data[1962]))
	"\173"/* End of data[] */;
#define      hide_z	4096
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask  = (unsigned long)&chkenv;
	mask ^= (unsigned long)getpid() * ~mask;
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
#	define PTRACE_ATTACH	PT_ATTACH
#endif
void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PTRACE_ATTACH, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = getenv("_");
	if (me == NULL) { me = argv[0]; }

	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	ret = chkenv(argc);
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
