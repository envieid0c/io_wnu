#if 0
	shc Version 3.9.3a3, Generic Shell Script Compiler
	GNU GPL Version 3 Fedor Mankov <envieidoc@gmail.com>

	./shc -v -r -f io_wnu_uninstall.sh 
#endif

static  char data [] = 
#define      date_z	1
#define      date	((&data[0]))
	"\341"
#define      tst2_z	19
#define      tst2	((&data[2]))
	"\145\105\245\101\040\254\242\074\125\332\002\355\045\027\332\223"
	"\314\330\203\357"
#define      opts_z	1
#define      opts	((&data[21]))
	"\125"
#define      xecc_z	15
#define      xecc	((&data[24]))
	"\120\163\030\354\205\225\070\313\222\326\162\303\225\027\354\120"
	"\033\364"
#define      chk2_z	19
#define      chk2	((&data[43]))
	"\042\030\373\030\173\245\357\271\332\330\321\317\266\372\123\321"
	"\220\222\224\370\210\126\212\031\176\004"
#define      text_z	1100
#define      text	((&data[264]))
	"\216\324\040\165\234\204\067\056\334\370\136\337\053\171\273\275"
	"\253\061\235\131\371\066\362\070\061\133\206\331\271\177\071\166"
	"\213\012\175\152\020\011\352\151\005\273\232\027\355\330\242\105"
	"\236\164\300\066\276\174\307\234\160\270\355\334\365\251\142\100"
	"\372\152\142\067\010\215\253\001\026\265\316\017\020\257\331\041"
	"\222\327\123\256\122\342\341\374\112\373\007\277\021\244\356\167"
	"\107\032\061\153\262\234\374\214\131\126\031\324\033\264\170\363"
	"\060\077\016\036\063\355\011\363\372\135\166\361\004\171\142\323"
	"\060\100\243\112\322\042\026\054\105\247\151\334\220\337\202\252"
	"\210\336\131\363\126\035\073\367\365\352\345\044\060\150\177\271"
	"\247\376\006\040\243\165\054\334\144\106\263\201\060\142\015\106"
	"\000\277\255\114\314\275\167\055\033\141\342\050\005\334\261\107"
	"\233\230\304\210\154\246\033\322\155\101\175\050\267\357\363\004"
	"\345\126\261\011\317\267\034\203\356\064\251\135\175\044\370\164"
	"\215\312\322\274\243\163\335\153\250\223\027\340\210\103\347\315"
	"\154\021\366\173\073\322\332\076\237\253\006\312\230\211\057\310"
	"\116\316\131\204\044\330\014\251\003\005\311\024\165\226\153\232"
	"\333\040\142\253\131\215\250\154\237\011\067\234\113\126\271\306"
	"\330\273\347\043\350\232\073\117\304\003\327\355\332\361\367\114"
	"\173\007\211\230\222\236\106\264\031\136\022\265\333\014\206\372"
	"\337\061\024\254\150\221\337\066\331\210\040\313\240\023\132\051"
	"\155\031\203\077\334\267\250\062\031\335\125\041\117\243\160\151"
	"\300\037\176\246\236\220\345\276\323\221\376\150\025\137\142\056"
	"\276\113\114\110\201\311\327\333\220\120\111\343\070\013\021\045"
	"\236\040\105\311\257\114\333\063\340\156\215\153\061\023\320\370"
	"\070\344\335\036\106\307\226\054\206\257\366\323\252\340\021\153"
	"\251\054\242\146\041\177\111\243\067\252\131\254\143\120\136\156"
	"\135\263\252\326\102\163\222\264\100\213\374\126\021\001\324\362"
	"\151\130\215\047\117\115\135\355\070\314\341\034\356\303\317\373"
	"\002\264\360\246\341\301\323\066\043\055\305\271\113\306\045\036"
	"\042\311\364\250\011\122\041\156\064\275\315\110\043\261\241\260"
	"\362\035\335\107\344\002\025\112\362\244\070\341\215\307\073\314"
	"\115\303\147\276\234\054\261\334\333\270\014\151\352\150\112\062"
	"\375\222\335\035\005\174\160\046\236\051\020\144\123\226\066\200"
	"\060\071\126\041\366\065\176\275\313\331\212\324\341\240\357\360"
	"\267\241\251\272\210\010\157\060\231\337\015\341\270\212\143\120"
	"\372\100\125\374\010\132\334\045\247\122\313\130\042\060\050\240"
	"\343\176\207\035\202\340\050\234\112\304\312\126\167\011\044\300"
	"\032\306\076\372\140\107\247\367\237\271\375\245\054\303\364\274"
	"\167\173\124\264\272\336\364\044\203\151\332\366\161\226\347\260"
	"\274\043\100\234\356\116\234\236\262\263\103\175\325\075\017\112"
	"\322\323\275\047\110\050\375\134\224\305\161\332\054\232\226\364"
	"\022\204\065\204\051\115\341\240\171\323\027\301\143\015\077\070"
	"\017\024\171\054\021\150\366\072\121\127\300\331\351\237\335\016"
	"\244\041\031\224\222\377\260\031\036\366\172\045\000\044\323\213"
	"\254\056\004\264\127\155\302\105\154\000\314\360\127\003\103\142"
	"\121\032\336\245\123\075\370\332\261\214\144\212\354\316\053\227"
	"\346\205\316\053\221\237\063\143\175\137\027\253\051\153\365\231"
	"\004\354\303\317\323\266\153\172\007\200\110\353\255\224\167\070"
	"\312\151\257\112\342\075\144\176\201\105\026\215\000\020\260\012"
	"\204\145\365\166\177\140\332\162\221\351\300\104\006\230\172\235"
	"\103\256\377\376\136\221\173\341\144\133\361\153\170\013\267\213"
	"\177\316\065\315\032\145\107\071\266\320\024\062\071\150\115\216"
	"\336\321\151\236\161\207\004\126\323\122\076\017\247\007\214\041"
	"\131\013\114\042\207\321\051\016\262\342\271\044\130\026\272\253"
	"\371\367\035\047\125\062\264\305\226\264\052\215\303\042\233\151"
	"\205\324\106\153\004\056\103\235\023\050\335\272\075\116\113\330"
	"\251\325\360\345\267\171\043\305\166\364\322\120\332\274\144\337"
	"\016\303\227\333\363\354\222\313\362\032\020\110\367\174\200\001"
	"\277\305\006\174\103\132\357\131\117\323\023\233\025\304\167\151"
	"\234\307\324\100\337\266\314\041\113\173\256\062\374\205\125\075"
	"\316\174\211\164\300\155\313\067\037\344\043\242\336\072\153\120"
	"\147\365\047\271\040\131\006\275\321\370\320\367\374\126\045\206"
	"\205\164\233\374\335\233\143\062\235\311\274\211\277\156\021\375"
	"\075\170\152\032\114\246\125\316\340\113\035\051\232\251\210\064"
	"\206\300\254\236\323\265\037\322\165\261\227\111\343\207\276\274"
	"\156\357\075\011\213\345\055\002\123\202\231\016\020\372\014\237"
	"\013\062\306\315\237\065\012\330\353\137\332\177\272\377\202\135"
	"\375\275\034\057\263\004\056\107\141\313\027\337\227\211\001\362"
	"\057\332\267\273\144\361\102\234\321\276\367\343\176\055\311\262"
	"\165\046\122\271\000\233\053\123\305\003\131\116\174\255\031\107"
	"\140\071\202\142\216\341\076\015\213\371\157\170\152\071\004\312"
	"\315\236\200\042\171\070\323\350\133\016\053\245\040\314\143\170"
	"\263\067\120\116\142\053\163\305\347\141\334\100\325\365\272\153"
	"\001\110\315\101\034\115\224\050\234\335\074\172\060\316\351\066"
	"\354\011\241\011\042\067\255\136\161\042\244\223\320\016\327\304"
	"\133\310\144\245\155\271\373\331\224\336\026\034\365\151\210\007"
	"\233\003\371\374\173\353\270\141\066\353\206\015\073\242\373\200"
	"\325\027\162\371\026\140\333\104\267\325\265\327\165\320\220\355"
	"\025\352\344\334\264\366\244\141\351\101\276\067\204\114\234\120"
	"\147\105\032\347\277\164\313\306\050\066\374\211\253\121\250\271"
	"\337\122\301\077\075\062\161\256\007\127\026\075\217\127\034\113"
	"\116\217\104\234\313\231\337\030\375\122\152\100\126\226\171\373"
	"\064\102\300\076\302\001\072\133\141\107\264\335\105"
#define      pswd_z	256
#define      pswd	((&data[1422]))
	"\302\021\007\240\130\071\304\032\046\064\201\177\147\315\016\103"
	"\267\174\332\251\035\252\251\200\146\332\203\324\247\253\011\146"
	"\277\267\201\202\211\366\104\373\223\102\235\322\032\057\217\373"
	"\143\252\127\342\234\336\341\066\103\073\120\316\050\311\143\337"
	"\072\052\376\315\045\070\030\335\106\200\006\332\327\350\100\173"
	"\342\000\075\166\054\367\345\344\052\026\161\064\207\324\131\003"
	"\204\165\317\176\071\343\136\304\312\074\132\214\064\045\126\223"
	"\167\011\320\347\060\125\056\155\047\012\052\320\020\214\056\223"
	"\027\277\101\122\032\053\165\313\110\315\050\365\134\103\117\041"
	"\030\107\236\145\225\124\177\241\020\030\102\343\030\130\207\136"
	"\350\022\036\123\010\136\230\151\036\043\013\242\170\074\311\006"
	"\171\307\007\233\231\146\253\107\021\027\331\170\016\346\221\157"
	"\054\152\367\275\230\121\331\170\005\037\103\223\343\342\025\107"
	"\320\135\017\026\273\120\061\140\253\217\234\220\100\156\346\012"
	"\301\003\007\205\034\040\067\337\027\366\316\233\113\113\026\041"
	"\350\204\072\060\012\013\024\057\307\207\264\141\345\354\052\212"
	"\172\312\042\064\252\340\326\105\301\375\026\337\230\324\260\252"
	"\014\142\324\025\125\247\242\172\153\263\331\242\274\057\200\336"
	"\373\136\312\224\042\157\063"
#define      msg2_z	19
#define      msg2	((&data[1704]))
	"\202\147\042\305\117\274\147\327\123\067\051\167\352\071\374\247"
	"\203\267\361\301\333"
#define      rlax_z	1
#define      rlax	((&data[1723]))
	"\055"
#define      msg1_z	62
#define      msg1	((&data[1737]))
	"\120\340\002\362\106\357\263\324\217\301\104\006\220\126\257\245"
	"\041\275\033\004\174\143\267\171\060\122\136\150\104\133\075\013"
	"\075\112\011\376\237\262\203\100\000\112\143\271\313\033\072\044"
	"\146\042\172\350\152\222\173\012\226\147\217\024\054\254\215\166"
	"\156\017\361\173\017\161\007\005\364\335\254\032\102\101\060\247"
	"\041\155\343\161"
#define      lsto_z	1
#define      lsto	((&data[1808]))
	"\347"
#define      shll_z	10
#define      shll	((&data[1809]))
	"\027\046\004\205\227\140\246\314\223\225"
#define      tst1_z	22
#define      tst1	((&data[1822]))
	"\320\215\167\017\153\255\326\041\151\362\166\152\275\172\357\052"
	"\336\310\363\172\345\356\222\210\116\065"
#define      chk1_z	22
#define      chk1	((&data[1847]))
	"\103\104\004\253\206\020\002\251\101\173\377\251\342\053\272\264"
	"\053\340\323\007\214\301\107\015"
#define      inlo_z	3
#define      inlo	((&data[1869]))
	"\377\211\007"/* End of data[] */;
#define      hide_z	4096
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask  = (unsigned long)&chkenv;
	mask ^= (unsigned long)getpid() * ~mask;
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
#	define PTRACE_ATTACH	PT_ATTACH
#endif
void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PTRACE_ATTACH, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = getenv("_");
	if (me == NULL) { me = argv[0]; }

	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	ret = chkenv(argc);
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
