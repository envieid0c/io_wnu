#if 0
	shc Version 3.9.3a3, Generic Shell Script Compiler
	GNU GPL Version 3 Fedor Mankov <envieidoc@gmail.com>

	./shc -v -r -f io_wnu_uninstall.sh 
#endif

static  char data [] = 
#define      inlo_z	3
#define      inlo	((&data[0]))
	"\236\265\314"
#define      msg2_z	19
#define      msg2	((&data[5]))
	"\323\277\066\023\266\242\344\300\156\135\363\312\260\213\125\021"
	"\325\210\370\354\171\355\271"
#define      rlax_z	1
#define      rlax	((&data[26]))
	"\240"
#define      lsto_z	1
#define      lsto	((&data[27]))
	"\222"
#define      tst2_z	19
#define      tst2	((&data[28]))
	"\362\323\151\133\332\333\035\304\244\102\254\155\357\227\335\054"
	"\377\124\240\175\041\136"
#define      opts_z	1
#define      opts	((&data[50]))
	"\212"
#define      xecc_z	15
#define      xecc	((&data[51]))
	"\072\204\332\304\337\374\331\167\035\040\253\345\025\332\353\367"
#define      msg1_z	62
#define      msg1	((&data[69]))
	"\100\257\374\375\060\362\051\050\111\231\011\032\140\017\150\102"
	"\266\152\147\347\123\217\122\110\247\155\220\315\222\251\233\261"
	"\102\263\314\206\150\226\050\311\221\234\362\257\037\054\156\145"
	"\075\137\205\232\112\261\334\060\073\034\160\056\045\251\222\352"
	"\353\127\323\357\337\145\212\051\357\105\331\215\153\014\150"
#define      pswd_z	256
#define      pswd	((&data[203]))
	"\103\347\335\101\152\203\006\375\374\234\366\003\030\267\135\255"
	"\232\164\354\300\227\070\214\117\367\063\117\033\164\044\322\337"
	"\027\074\301\207\310\063\175\357\135\024\122\010\110\240\073\202"
	"\324\276\211\136\347\147\340\257\062\110\153\274\005\303\211\276"
	"\271\301\323\074\263\163\077\176\250\040\011\334\123\333\166\173"
	"\354\242\211\212\263\017\345\071\011\251\241\356\351\041\026\026"
	"\012\106\004\143\130\101\042\102\232\352\350\205\354\077\103\227"
	"\174\026\113\166\174\067\331\164\141\214\272\344\036\010\027\153"
	"\014\006\337\327\242\003\003\152\367\355\047\125\144\062\351\214"
	"\041\105\261\004\125\032\150\223\171\373\076\263\141\214\373\172"
	"\101\167\310\261\217\220\134\037\065\000\372\164\176\024\134\127"
	"\027\142\204\030\255\105\003\214\252\116\027\317\217\022\201\033"
	"\217\152\375\252\106\212\314\026\052\064\046\064\020\164\306\151"
	"\005\343\162\335\371\376\057\016\110\116\317\073\003\020\272\252"
	"\133\024\225\324\252\124\210\143\273\043\300\325\344\054\064\014"
	"\356\105\056\061\156\054\052\355\014\136\137\106\053\236\101\020"
	"\173\150\105\004\221\122\066\152\117\011\212\242\273\072\335\243"
	"\370\335\251\317\230\173\343\141\131\276\325\246\027\365\210\066"
	"\373\063\247\275\112\123\046\354\062\346\121\203\205\335\203\157"
	"\215\222\367\242\204\061\254\133\261\153\006\235\345\352\334\010"
	"\105\132\163\276\343\137\011\150\016\325\364\237\272\166\062\365"
#define      tst1_z	22
#define      tst1	((&data[487]))
	"\252\214\243\243\020\353\266\127\102\265\100\010\374\363\204\362"
	"\326\202\311\353\170\040\051\163\224\121\021\312"
#define      chk1_z	22
#define      chk1	((&data[515]))
	"\305\170\065\116\131\124\071\065\055\174\135\320\322\331\236\370"
	"\253\276\007\370\156\306\076\222\144\267\333\371\152\313\003"
#define      text_z	1100
#define      text	((&data[629]))
	"\107\177\161\173\230\373\127\132\026\146\264\056\147\054\201\244"
	"\032\025\112\014\337\021\324\321\126\040\327\310\102\151\302\106"
	"\037\142\122\233\206\262\201\141\206\107\054\015\120\135\333\127"
	"\132\274\007\310\224\052\246\225\177\213\261\105\370\227\027\353"
	"\151\117\123\340\143\271\227\356\325\274\312\037\042\241\267\304"
	"\015\136\317\253\323\067\047\304\063\166\313\316\143\367\226\137"
	"\262\345\011\334\227\021\363\356\003\114\036\224\220\265\367\065"
	"\070\311\364\167\030\030\064\044\037\037\312\255\276\067\303\043"
	"\270\103\370\157\167\004\132\010\112\330\244\335\311\032\230\362"
	"\272\120\374\117\260\333\027\366\156\222\046\247\162\316\371\176"
	"\014\331\323\067\320\050\016\076\353\037\046\262\122\257\036\216"
	"\231\140\017\132\020\221\036\350\063\056\074\074\100\174\301\075"
	"\357\111\325\362\064\150\053\340\267\323\343\267\006\366\167\362"
	"\073\035\063\154\142\376\305\256\033\130\176\137\145\072\344\335"
	"\122\045\066\352\172\273\227\221\012\312\123\071\356\047\076\154"
	"\134\043\043\246\223\111\343\111\125\124\337\245\025\057\160\173"
	"\024\034\160\144\170\252\304\046\316\101\261\253\160\215\272\205"
	"\123\330\247\102\114\042\176\301\216\056\224\151\327\014\200\353"
	"\037\300\202\320\311\120\271\327\274\040\132\044\261\264\172\227"
	"\276\016\036\205\272\200\025\133\162\125\224\245\247\363\171\211"
	"\154\354\306\210\066\127\150\127\316\107\325\304\124\355\035\317"
	"\236\077\233\220\144\010\335\137\074\236\361\352\005\041\114\077"
	"\232\231\245\302\072\313\066\337\157\104\141\233\176\312\301\267"
	"\174\010\360\170\023\073\157\236\113\115\341\274\240\302\242\024"
	"\360\260\203\061\325\160\367\157\026\260\266\157\131\106\361\027"
	"\120\340\243\212\327\301\010\042\360\355\377\012\020\051\207\122"
	"\154\143\165\145\044\033\113\171\251\333\062\123\140\334\206\102"
	"\310\015\040\030\172\036\322\366\045\362\234\153\116\116\237\120"
	"\060\322\351\140\061\272\112\016\350\363\006\351\172\243\137\045"
	"\375\374\131\304\315\354\105\325\352\217\124\247\125\334\006\141"
	"\231\110\374\166\157\013\304\320\162\313\143\245\345\243\257\020"
	"\052\044\057\270\362\334\135\160\221\115\365\367\143\167\116\115"
	"\156\241\013\353\120\021\237\352\163\127\117\207\233\264\164\227"
	"\064\177\267\316\076\200\004\146\065\313\033\007\007\270\177\012"
	"\212\036\345\075\356\275\230\336\107\024\157\000\050\263\250\074"
	"\147\051\312\027\145\274\154\057\212\366\062\013\136\222\057\367"
	"\322\275\133\230\176\115\367\243\140\056\365\130\267\155\323\072"
	"\142\227\055\117\335\153\046\230\337\013\205\055\275\320\223\256"
	"\013\303\077\217\137\340\144\174\022\227\210\072\035\000\367\220"
	"\247\024\306\146\337\120\361\344\331\241\121\360\375\355\107\327"
	"\131\221\136\233\003\327\121\265\110\111\104\363\217\107\353\056"
	"\070\224\170\174\220\335\335\170\030\016\157\222\265\101\364\043"
	"\047\142\117\354\140\376\046\201\060\210\336\137\251\173\233\354"
	"\306\371\027\002\360\115\243\234\110\005\174\035\155\151\140\354"
	"\130\276\300\152\071\263\117\141\245\241\302\060\116\016\226\077"
	"\333\362\126\365\141\131\371\337\051\226\271\101\344\355\256\074"
	"\055\264\126\101\244\250\055\044\215\133\235\320\167\322\354\353"
	"\063\052\376\004\017\015\342\364\375\072\021\060\162\231\353\212"
	"\040\220\242\236\305\305\310\276\330\150\365\163\210\313\123\346"
	"\067\230\276\314\174\040\101\146\126\135\134\326\221\030\021\123"
	"\243\046\370\330\212\075\056\353\141\250\023\157\006\222\047\122"
	"\341\140\017\223\343\273\272\242\045\222\052\220\054\304\311\000"
	"\222\013\035\030\327\200\303\000\054\204\356\111\123\345\303\222"
	"\223\243\054\026\060\343\051\171\014\234\126\267\010\311\155\117"
	"\165\245\054\032\123\200\365\101\160\056\020\342\150\373\112\224"
	"\277\054\176\100\177\006\344\151\122\044\124\075\025\314\062\342"
	"\122\023\142\330\065\017\076\050\073\270\334\124\201\264\277\132"
	"\131\334\111\314\044\121\345\241\101\376\264\027\133\251\357\337"
	"\162\343\267\346\061\363\240\012\250\202\232\110\205\054\075\315"
	"\370\067\254\370\360\010\300\325\373\351\134\302\220\225\276\124"
	"\321\237\250\121\274\356\043\321\331\012\012\105\207\123\264\225"
	"\064\355\224\163\035\007\177\057\126\163\237\256\214\370\054\055"
	"\274\167\371\111\036\320\307\357\157\043\357\116\012\344\042\062"
	"\075\324\353\022\232\066\041\072\141\314\041\211\366\327\176\204"
	"\360\047\064\012\046\111\144\210\127\064\357\254\207\243\164\163"
	"\056\053\052\114\327\342\104\331\323\271\136\353\243\111\041\316"
	"\170\201\004\066\214\161\357\344\262\034\175\072\253\336\046\111"
	"\227\242\200\276\303\322\273\203\342\032\270\132\221\131\232\045"
	"\371\001\025\372\246\241\311\227\212\335\042\016\253\005\337\104"
	"\044\001\216\074\256\133\002\364\103\276\344\056\254\265\257\206"
	"\257\040\131\365\010\040\247\057\104\264\334\337\023\303\132\051"
	"\001\236\374\114\202\235\227\200\223\307\353\345\305\221\034\012"
	"\310\140\164\172\345\232\145\157\104\250\172\131\213\376\011\305"
	"\327\045\107\057\327\101\151\224\225\242\326\260\200\157\373\221"
	"\051\267\133\114\211\346\054\007\253\307\305\045\370\277\017\345"
	"\275\145\212\136\146\274\016\261\170\346\264\152\056\054\064\022"
	"\140\351\326\344\245\257\011\271\224\227\207\042\365\075\302\041"
	"\271\325\127\235\330\342\331\216\072\134\061\003\135\002\334\121"
	"\231\245\177\376\321\161\004\222\357\216\020\374\156\033\323\313"
	"\210\373\046\075\262\337\232\330\362\121\136\137\000\334\160\140"
	"\306\166\261\042\105\004\060\266\317\344\212\165\171"
#define      chk2_z	19
#define      chk2	((&data[1835]))
	"\060\351\372\057\151\223\101\135\036\177\010\026\275\211\012\147"
	"\371\034\347\144"
#define      shll_z	10
#define      shll	((&data[1855]))
	"\036\232\152\327\260\235\071\330\004\223\113\007\330"
#define      date_z	1
#define      date	((&data[1867]))
	"\277"/* End of data[] */;
#define      hide_z	4096
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask  = (unsigned long)&chkenv;
	mask ^= (unsigned long)getpid() * ~mask;
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
#	define PTRACE_ATTACH	PT_ATTACH
#endif
void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PTRACE_ATTACH, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = getenv("_");
	if (me == NULL) { me = argv[0]; }

	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	ret = chkenv(argc);
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
